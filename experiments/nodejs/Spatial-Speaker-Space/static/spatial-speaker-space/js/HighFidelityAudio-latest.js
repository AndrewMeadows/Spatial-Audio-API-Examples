var HighFidelityAudio;HighFidelityAudio=(()=>{var t={591:(t,e,i)=>{"use strict";const{Deflate:n,deflate:a,deflateRaw:s,gzip:o}=i(555),{Inflate:r,inflate:l,inflateRaw:d,ungzip:h}=i(843),u=i(619);t.exports.Deflate=n,t.exports.deflate=a,t.exports.deflateRaw=s,t.exports.gzip=o,t.exports.Inflate=r,t.exports.inflate=l,t.exports.inflateRaw=d,t.exports.ungzip=h,t.exports.constants=u},555:(t,e,i)=>{"use strict";const n=i(405),a=i(236),s=i(373),o=i(898),r=i(292),l=Object.prototype.toString,{Z_NO_FLUSH:d,Z_SYNC_FLUSH:h,Z_FULL_FLUSH:u,Z_FINISH:c,Z_OK:_,Z_STREAM_END:g,Z_DEFAULT_COMPRESSION:m,Z_DEFAULT_STRATEGY:f,Z_DEFLATED:p}=i(619);function v(t){this.options=a.assign({level:m,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:f},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new r,this.strm.avail_out=0;let i=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==_)throw new Error(o[i]);if(e.header&&n.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?s.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,i=n.deflateSetDictionary(this.strm,t),i!==_)throw new Error(o[i]);this._dict_set=!0}}function S(t,e){const i=new v(e);if(i.push(t,!0),i.err)throw i.msg||o[i.err];return i.result}v.prototype.push=function(t,e){const i=this.strm,a=this.options.chunkSize;let o,r;if(this.ended)return!1;for(r=e===~~e?e:!0===e?c:d,"string"==typeof t?i.input=s.string2buf(t):"[object ArrayBuffer]"===l.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),(r===h||r===u)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(o=n.deflate(i,r),o===g)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),o=n.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===_;if(0!==i.avail_out){if(r>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},v.prototype.onData=function(t){this.chunks.push(t)},v.prototype.onEnd=function(t){t===_&&(this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},t.exports.Deflate=v,t.exports.deflate=S,t.exports.deflateRaw=function(t,e){return(e=e||{}).raw=!0,S(t,e)},t.exports.gzip=function(t,e){return(e=e||{}).gzip=!0,S(t,e)},t.exports.constants=i(619)},843:(t,e,i)=>{"use strict";const n=i(948),a=i(236),s=i(373),o=i(898),r=i(292),l=i(401),d=Object.prototype.toString,{Z_NO_FLUSH:h,Z_FINISH:u,Z_OK:c,Z_STREAM_END:_,Z_NEED_DICT:g,Z_STREAM_ERROR:m,Z_DATA_ERROR:f,Z_MEM_ERROR:p}=i(619);function v(t){this.options=a.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new r,this.strm.avail_out=0;let i=n.inflateInit2(this.strm,e.windowBits);if(i!==c)throw new Error(o[i]);if(this.header=new l,n.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=s.string2buf(e.dictionary):"[object ArrayBuffer]"===d.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=n.inflateSetDictionary(this.strm,e.dictionary),i!==c)))throw new Error(o[i])}function S(t,e){const i=new v(e);if(i.push(t),i.err)throw i.msg||o[i.err];return i.result}v.prototype.push=function(t,e){const i=this.strm,a=this.options.chunkSize,o=this.options.dictionary;let r,l,v;if(this.ended)return!1;for(l=e===~~e?e:!0===e?u:h,"[object ArrayBuffer]"===d.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),r=n.inflate(i,l),r===g&&o&&(r=n.inflateSetDictionary(i,o),r===c?r=n.inflate(i,l):r===f&&(r=g));i.avail_in>0&&r===_&&i.state.wrap>0&&0!==t[i.next_in];)n.inflateReset(i),r=n.inflate(i,l);switch(r){case m:case f:case g:case p:return this.onEnd(r),this.ended=!0,!1}if(v=i.avail_out,i.next_out&&(0===i.avail_out||r===_))if("string"===this.options.to){let t=s.utf8border(i.output,i.next_out),e=i.next_out-t,n=s.buf2string(i.output,t);i.next_out=e,i.avail_out=a-e,e&&i.output.set(i.output.subarray(t,t+e),0),this.onData(n)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(r!==c||0!==v){if(r===_)return r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},v.prototype.onData=function(t){this.chunks.push(t)},v.prototype.onEnd=function(t){t===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},t.exports.Inflate=v,t.exports.inflate=S,t.exports.inflateRaw=function(t,e){return(e=e||{}).raw=!0,S(t,e)},t.exports.ungzip=S,t.exports.constants=i(619)},236:t=>{"use strict";const e=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);t.exports.assign=function(t){const i=Array.prototype.slice.call(arguments,1);for(;i.length;){const n=i.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const i in n)e(n,i)&&(t[i]=n[i])}}return t},t.exports.flattenChunks=t=>{let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i].length;const i=new Uint8Array(e);for(let e=0,n=0,a=t.length;e<a;e++){let a=t[e];i.set(a,n),n+=a.length}return i}},373:t=>{"use strict";let e=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){e=!1}const i=new Uint8Array(256);for(let t=0;t<256;t++)i[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;i[254]=i[254]=1,t.exports.string2buf=t=>{let e,i,n,a,s,o=t.length,r=0;for(a=0;a<o;a++)i=t.charCodeAt(a),55296==(64512&i)&&a+1<o&&(n=t.charCodeAt(a+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),a++)),r+=i<128?1:i<2048?2:i<65536?3:4;for(e=new Uint8Array(r),s=0,a=0;s<r;a++)i=t.charCodeAt(a),55296==(64512&i)&&a+1<o&&(n=t.charCodeAt(a+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),a++)),i<128?e[s++]=i:i<2048?(e[s++]=192|i>>>6,e[s++]=128|63&i):i<65536?(e[s++]=224|i>>>12,e[s++]=128|i>>>6&63,e[s++]=128|63&i):(e[s++]=240|i>>>18,e[s++]=128|i>>>12&63,e[s++]=128|i>>>6&63,e[s++]=128|63&i);return e},t.exports.buf2string=(t,n)=>{let a,s;const o=n||t.length,r=new Array(2*o);for(s=0,a=0;a<o;){let e=t[a++];if(e<128){r[s++]=e;continue}let n=i[e];if(n>4)r[s++]=65533,a+=n-1;else{for(e&=2===n?31:3===n?15:7;n>1&&a<o;)e=e<<6|63&t[a++],n--;n>1?r[s++]=65533:e<65536?r[s++]=e:(e-=65536,r[s++]=55296|e>>10&1023,r[s++]=56320|1023&e)}}return((t,i)=>{if(i<65534&&t.subarray&&e)return String.fromCharCode.apply(null,t.length===i?t:t.subarray(0,i));let n="";for(let e=0;e<i;e++)n+=String.fromCharCode(t[e]);return n})(r,s)},t.exports.utf8border=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let n=e-1;for(;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+i[t[n]]>e?n:e}},69:t=>{"use strict";t.exports=(t,e,i,n)=>{let a=65535&t|0,s=t>>>16&65535|0,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do{a=a+e[n++]|0,s=s+a|0}while(--o);a%=65521,s%=65521}return a|s<<16|0}},619:t=>{"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},869:t=>{"use strict";const e=new Uint32Array((()=>{let t,e=[];for(var i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e})());t.exports=(t,i,n,a)=>{const s=e,o=a+n;t^=-1;for(let e=a;e<o;e++)t=t>>>8^s[255&(t^i[e])];return-1^t}},405:(t,e,i)=>{"use strict";const{_tr_init:n,_tr_stored_block:a,_tr_flush_block:s,_tr_tally:o,_tr_align:r}=i(342),l=i(69),d=i(869),h=i(898),{Z_NO_FLUSH:u,Z_PARTIAL_FLUSH:c,Z_FULL_FLUSH:_,Z_FINISH:g,Z_BLOCK:m,Z_OK:f,Z_STREAM_END:p,Z_STREAM_ERROR:v,Z_DATA_ERROR:S,Z_BUF_ERROR:b,Z_DEFAULT_COMPRESSION:w,Z_FILTERED:C,Z_HUFFMAN_ONLY:A,Z_RLE:y,Z_FIXED:x,Z_DEFAULT_STRATEGY:R,Z_UNKNOWN:D,Z_DEFLATED:I}=i(619),k=258,F=262,T=103,H=113,U=666,E=(t,e)=>(t.msg=h[e],e),O=t=>(t<<1)-(t>4?9:0),P=t=>{let e=t.length;for(;--e>=0;)t[e]=0};let L=(t,e,i)=>(e<<t.hash_shift^i)&t.hash_mask;const N=t=>{const e=t.state;let i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+i),t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))},M=(t,e)=>{s(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,N(t.strm)},z=(t,e)=>{t.pending_buf[t.pending++]=e},Q=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Z=(t,e,i,n)=>{let a=t.avail_in;return a>n&&(a=n),0===a?0:(t.avail_in-=a,e.set(t.input.subarray(t.next_in,t.next_in+a),i),1===t.state.wrap?t.adler=l(t.adler,e,a,i):2===t.state.wrap&&(t.adler=d(t.adler,e,a,i)),t.next_in+=a,t.total_in+=a,a)},B=(t,e)=>{let i,n,a=t.max_chain_length,s=t.strstart,o=t.prev_length,r=t.nice_match;const l=t.strstart>t.w_size-F?t.strstart-(t.w_size-F):0,d=t.window,h=t.w_mask,u=t.prev,c=t.strstart+k;let _=d[s+o-1],g=d[s+o];t.prev_length>=t.good_match&&(a>>=2),r>t.lookahead&&(r=t.lookahead);do{if(i=e,d[i+o]===g&&d[i+o-1]===_&&d[i]===d[s]&&d[++i]===d[s+1]){s+=2,i++;do{}while(d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&s<c);if(n=k-(c-s),s=c-k,n>o){if(t.match_start=e,o=n,n>=r)break;_=d[s+o-1],g=d[s+o]}}}while((e=u[e&h])>l&&0!=--a);return o<=t.lookahead?o:t.lookahead},K=t=>{const e=t.w_size;let i,n,a,s,o;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-F)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,i=n;do{a=t.head[--i],t.head[i]=a>=e?a-e:0}while(--n);n=e,i=n;do{a=t.prev[--i],t.prev[i]=a>=e?a-e:0}while(--n);s+=e}if(0===t.strm.avail_in)break;if(n=Z(t.strm,t.window,t.strstart+t.lookahead,s),t.lookahead+=n,t.lookahead+t.insert>=3)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=L(t,t.ins_h,t.window[o+1]);t.insert&&(t.ins_h=L(t,t.ins_h,t.window[o+3-1]),t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<F&&0!==t.strm.avail_in)},V=(t,e)=>{let i,n;for(;;){if(t.lookahead<F){if(K(t),t.lookahead<F&&e===u)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=L(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-F&&(t.match_length=B(t,i)),t.match_length>=3)if(n=o(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=L(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=L(t,t.ins_h,t.window[t.strstart+1]);else n=o(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(M(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===g?(M(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(M(t,!1),0===t.strm.avail_out)?1:2},$=(t,e)=>{let i,n,a;for(;;){if(t.lookahead<F){if(K(t),t.lookahead<F&&e===u)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=L(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-F&&(t.match_length=B(t,i),t.match_length<=5&&(t.strategy===C||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){a=t.strstart+t.lookahead-3,n=o(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=a&&(t.ins_h=L(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(M(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(n=o(t,0,t.window[t.strstart-1]),n&&M(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=o(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===g?(M(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(M(t,!1),0===t.strm.avail_out)?1:2};function W(t,e,i,n,a){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=a}const j=[new W(0,0,0,0,((t,e)=>{let i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(K(t),0===t.lookahead&&e===u)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;const n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,M(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-F&&(M(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===g?(M(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(M(t,!1),t.strm.avail_out),1)})),new W(4,4,8,4,V),new W(4,5,16,8,V),new W(4,6,32,32,V),new W(4,4,16,16,$),new W(8,16,32,32,$),new W(8,16,128,128,$),new W(8,32,128,256,$),new W(32,128,258,1024,$),new W(32,258,258,4096,$)];function Y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=I,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),P(this.dyn_ltree),P(this.dyn_dtree),P(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),P(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),P(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const G=t=>{if(!t||!t.state)return E(t,v);t.total_in=t.total_out=0,t.data_type=D;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:H,t.adler=2===e.wrap?0:1,e.last_flush=u,n(e),f},X=t=>{const e=G(t);var i;return e===f&&((i=t.state).window_size=2*i.w_size,P(i.head),i.max_lazy_match=j[i.level].max_lazy,i.good_match=j[i.level].good_length,i.nice_match=j[i.level].nice_length,i.max_chain_length=j[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),e},J=(t,e,i,n,a,s)=>{if(!t)return v;let o=1;if(e===w&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),a<1||a>9||i!==I||n<8||n>15||e<0||e>9||s<0||s>x)return E(t,v);8===n&&(n=9);const r=new Y;return t.state=r,r.strm=t,r.wrap=o,r.gzhead=null,r.w_bits=n,r.w_size=1<<r.w_bits,r.w_mask=r.w_size-1,r.hash_bits=a+7,r.hash_size=1<<r.hash_bits,r.hash_mask=r.hash_size-1,r.hash_shift=~~((r.hash_bits+3-1)/3),r.window=new Uint8Array(2*r.w_size),r.head=new Uint16Array(r.hash_size),r.prev=new Uint16Array(r.w_size),r.lit_bufsize=1<<a+6,r.pending_buf_size=4*r.lit_bufsize,r.pending_buf=new Uint8Array(r.pending_buf_size),r.d_buf=1*r.lit_bufsize,r.l_buf=3*r.lit_bufsize,r.level=e,r.strategy=s,r.method=i,X(t)};t.exports.deflateInit=(t,e)=>J(t,e,I,15,8,R),t.exports.deflateInit2=J,t.exports.deflateReset=X,t.exports.deflateResetKeep=G,t.exports.deflateSetHeader=(t,e)=>t&&t.state?2!==t.state.wrap?v:(t.state.gzhead=e,f):v,t.exports.deflate=(t,e)=>{let i,n;if(!t||!t.state||e>m||e<0)return t?E(t,v):v;const s=t.state;if(!t.output||!t.input&&0!==t.avail_in||s.status===U&&e!==g)return E(t,0===t.avail_out?b:v);s.strm=t;const l=s.last_flush;if(s.last_flush=e,42===s.status)if(2===s.wrap)t.adler=0,z(s,31),z(s,139),z(s,8),s.gzhead?(z(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),z(s,255&s.gzhead.time),z(s,s.gzhead.time>>8&255),z(s,s.gzhead.time>>16&255),z(s,s.gzhead.time>>24&255),z(s,9===s.level?2:s.strategy>=A||s.level<2?4:0),z(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(z(s,255&s.gzhead.extra.length),z(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(t.adler=d(t.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(z(s,0),z(s,0),z(s,0),z(s,0),z(s,0),z(s,9===s.level?2:s.strategy>=A||s.level<2?4:0),z(s,3),s.status=H);else{let e=I+(s.w_bits-8<<4)<<8,i=-1;i=s.strategy>=A||s.level<2?0:s.level<6?1:6===s.level?2:3,e|=i<<6,0!==s.strstart&&(e|=32),e+=31-e%31,s.status=H,Q(s,e),0!==s.strstart&&(Q(s,t.adler>>>16),Q(s,65535&t.adler)),t.adler=1}if(69===s.status)if(s.gzhead.extra){for(i=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>i&&(t.adler=d(t.adler,s.pending_buf,s.pending-i,i)),N(t),i=s.pending,s.pending!==s.pending_buf_size));)z(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>i&&(t.adler=d(t.adler,s.pending_buf,s.pending-i,i)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(t.adler=d(t.adler,s.pending_buf,s.pending-i,i)),N(t),i=s.pending,s.pending===s.pending_buf_size)){n=1;break}n=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,z(s,n)}while(0!==n);s.gzhead.hcrc&&s.pending>i&&(t.adler=d(t.adler,s.pending_buf,s.pending-i,i)),0===n&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(t.adler=d(t.adler,s.pending_buf,s.pending-i,i)),N(t),i=s.pending,s.pending===s.pending_buf_size)){n=1;break}n=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,z(s,n)}while(0!==n);s.gzhead.hcrc&&s.pending>i&&(t.adler=d(t.adler,s.pending_buf,s.pending-i,i)),0===n&&(s.status=T)}else s.status=T;if(s.status===T&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&N(t),s.pending+2<=s.pending_buf_size&&(z(s,255&t.adler),z(s,t.adler>>8&255),t.adler=0,s.status=H)):s.status=H),0!==s.pending){if(N(t),0===t.avail_out)return s.last_flush=-1,f}else if(0===t.avail_in&&O(e)<=O(l)&&e!==g)return E(t,b);if(s.status===U&&0!==t.avail_in)return E(t,b);if(0!==t.avail_in||0!==s.lookahead||e!==u&&s.status!==U){let i=s.strategy===A?((t,e)=>{let i;for(;;){if(0===t.lookahead&&(K(t),0===t.lookahead)){if(e===u)return 1;break}if(t.match_length=0,i=o(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(M(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===g?(M(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(M(t,!1),0===t.strm.avail_out)?1:2})(s,e):s.strategy===y?((t,e)=>{let i,n,a,s;const r=t.window;for(;;){if(t.lookahead<=k){if(K(t),t.lookahead<=k&&e===u)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(a=t.strstart-1,n=r[a],n===r[++a]&&n===r[++a]&&n===r[++a])){s=t.strstart+k;do{}while(n===r[++a]&&n===r[++a]&&n===r[++a]&&n===r[++a]&&n===r[++a]&&n===r[++a]&&n===r[++a]&&n===r[++a]&&a<s);t.match_length=k-(s-a),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(i=o(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=o(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(M(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===g?(M(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(M(t,!1),0===t.strm.avail_out)?1:2})(s,e):j[s.level].func(s,e);if(3!==i&&4!==i||(s.status=U),1===i||3===i)return 0===t.avail_out&&(s.last_flush=-1),f;if(2===i&&(e===c?r(s):e!==m&&(a(s,0,0,!1),e===_&&(P(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),N(t),0===t.avail_out))return s.last_flush=-1,f}return e!==g?f:s.wrap<=0?p:(2===s.wrap?(z(s,255&t.adler),z(s,t.adler>>8&255),z(s,t.adler>>16&255),z(s,t.adler>>24&255),z(s,255&t.total_in),z(s,t.total_in>>8&255),z(s,t.total_in>>16&255),z(s,t.total_in>>24&255)):(Q(s,t.adler>>>16),Q(s,65535&t.adler)),N(t),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?f:p)},t.exports.deflateEnd=t=>{if(!t||!t.state)return v;const e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&e!==T&&e!==H&&e!==U?E(t,v):(t.state=null,e===H?E(t,S):f)},t.exports.deflateSetDictionary=(t,e)=>{let i=e.length;if(!t||!t.state)return v;const n=t.state,a=n.wrap;if(2===a||1===a&&42!==n.status||n.lookahead)return v;if(1===a&&(t.adler=l(t.adler,e,i,0)),n.wrap=0,i>=n.w_size){0===a&&(P(n.head),n.strstart=0,n.block_start=0,n.insert=0);let t=new Uint8Array(n.w_size);t.set(e.subarray(i-n.w_size,i),0),e=t,i=n.w_size}const s=t.avail_in,o=t.next_in,r=t.input;for(t.avail_in=i,t.next_in=0,t.input=e,K(n);n.lookahead>=3;){let t=n.strstart,e=n.lookahead-2;do{n.ins_h=L(n,n.ins_h,n.window[t+3-1]),n.prev[t&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=t,t++}while(--e);n.strstart=t,n.lookahead=2,K(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=o,t.input=r,t.avail_in=s,n.wrap=a,f},t.exports.deflateInfo="pako deflate (from Nodeca project)"},401:t=>{"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},264:t=>{"use strict";t.exports=function(t,e){let i,n,a,s,o,r,l,d,h,u,c,_,g,m,f,p,v,S,b,w,C,A,y,x;const R=t.state;i=t.next_in,y=t.input,n=i+(t.avail_in-5),a=t.next_out,x=t.output,s=a-(e-t.avail_out),o=a+(t.avail_out-257),r=R.dmax,l=R.wsize,d=R.whave,h=R.wnext,u=R.window,c=R.hold,_=R.bits,g=R.lencode,m=R.distcode,f=(1<<R.lenbits)-1,p=(1<<R.distbits)-1;t:do{_<15&&(c+=y[i++]<<_,_+=8,c+=y[i++]<<_,_+=8),v=g[c&f];e:for(;;){if(S=v>>>24,c>>>=S,_-=S,S=v>>>16&255,0===S)x[a++]=65535&v;else{if(!(16&S)){if(0==(64&S)){v=g[(65535&v)+(c&(1<<S)-1)];continue e}if(32&S){R.mode=12;break t}t.msg="invalid literal/length code",R.mode=30;break t}b=65535&v,S&=15,S&&(_<S&&(c+=y[i++]<<_,_+=8),b+=c&(1<<S)-1,c>>>=S,_-=S),_<15&&(c+=y[i++]<<_,_+=8,c+=y[i++]<<_,_+=8),v=m[c&p];i:for(;;){if(S=v>>>24,c>>>=S,_-=S,S=v>>>16&255,!(16&S)){if(0==(64&S)){v=m[(65535&v)+(c&(1<<S)-1)];continue i}t.msg="invalid distance code",R.mode=30;break t}if(w=65535&v,S&=15,_<S&&(c+=y[i++]<<_,_+=8,_<S&&(c+=y[i++]<<_,_+=8)),w+=c&(1<<S)-1,w>r){t.msg="invalid distance too far back",R.mode=30;break t}if(c>>>=S,_-=S,S=a-s,w>S){if(S=w-S,S>d&&R.sane){t.msg="invalid distance too far back",R.mode=30;break t}if(C=0,A=u,0===h){if(C+=l-S,S<b){b-=S;do{x[a++]=u[C++]}while(--S);C=a-w,A=x}}else if(h<S){if(C+=l+h-S,S-=h,S<b){b-=S;do{x[a++]=u[C++]}while(--S);if(C=0,h<b){S=h,b-=S;do{x[a++]=u[C++]}while(--S);C=a-w,A=x}}}else if(C+=h-S,S<b){b-=S;do{x[a++]=u[C++]}while(--S);C=a-w,A=x}for(;b>2;)x[a++]=A[C++],x[a++]=A[C++],x[a++]=A[C++],b-=3;b&&(x[a++]=A[C++],b>1&&(x[a++]=A[C++]))}else{C=a-w;do{x[a++]=x[C++],x[a++]=x[C++],x[a++]=x[C++],b-=3}while(b>2);b&&(x[a++]=x[C++],b>1&&(x[a++]=x[C++]))}break}}break}}while(i<n&&a<o);b=_>>3,i-=b,_-=b<<3,c&=(1<<_)-1,t.next_in=i,t.next_out=a,t.avail_in=i<n?n-i+5:5-(i-n),t.avail_out=a<o?o-a+257:257-(a-o),R.hold=c,R.bits=_}},948:(t,e,i)=>{"use strict";const n=i(69),a=i(869),s=i(264),o=i(241),{Z_FINISH:r,Z_BLOCK:l,Z_TREES:d,Z_OK:h,Z_STREAM_END:u,Z_NEED_DICT:c,Z_STREAM_ERROR:_,Z_DATA_ERROR:g,Z_MEM_ERROR:m,Z_BUF_ERROR:f,Z_DEFLATED:p}=i(619),v=12,S=30,b=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const C=t=>{if(!t||!t.state)return _;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,h},A=t=>{if(!t||!t.state)return _;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,C(t)},y=(t,e)=>{let i;if(!t||!t.state)return _;const n=t.state;return e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?_:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,A(t))},x=(t,e)=>{if(!t)return _;const i=new w;t.state=i,i.window=null;const n=y(t,e);return n!==h&&(t.state=null),n};let R,D,I=!0;const k=t=>{if(I){R=new Int32Array(512),D=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(o(1,t.lens,0,288,R,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;o(2,t.lens,0,32,D,0,t.work,{bits:5}),I=!1}t.lencode=R,t.lenbits=9,t.distcode=D,t.distbits=5},F=(t,e,i,n)=>{let a;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(i-s.wsize,i),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(e.subarray(i-n,i-n+a),s.wnext),(n-=a)?(s.window.set(e.subarray(i-n,i),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0};t.exports.inflateReset=A,t.exports.inflateReset2=y,t.exports.inflateResetKeep=C,t.exports.inflateInit=t=>x(t,15),t.exports.inflateInit2=x,t.exports.inflate=(t,e)=>{let i,w,C,A,y,x,R,D,I,T,H,U,E,O,P,L,N,M,z,Q,Z,B,K=0;const V=new Uint8Array(4);let $,W;const j=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return _;i=t.state,i.mode===v&&(i.mode=13),y=t.next_out,C=t.output,R=t.avail_out,A=t.next_in,w=t.input,x=t.avail_in,D=i.hold,I=i.bits,T=x,H=R,B=h;t:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;I<16;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}if(2&i.wrap&&35615===D){i.check=0,V[0]=255&D,V[1]=D>>>8&255,i.check=a(i.check,V,2,0),D=0,I=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&D)<<8)+(D>>8))%31){t.msg="incorrect header check",i.mode=S;break}if((15&D)!==p){t.msg="unknown compression method",i.mode=S;break}if(D>>>=4,I-=4,Z=8+(15&D),0===i.wbits)i.wbits=Z;else if(Z>i.wbits){t.msg="invalid window size",i.mode=S;break}i.dmax=1<<i.wbits,t.adler=i.check=1,i.mode=512&D?10:v,D=0,I=0;break;case 2:for(;I<16;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}if(i.flags=D,(255&i.flags)!==p){t.msg="unknown compression method",i.mode=S;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=S;break}i.head&&(i.head.text=D>>8&1),512&i.flags&&(V[0]=255&D,V[1]=D>>>8&255,i.check=a(i.check,V,2,0)),D=0,I=0,i.mode=3;case 3:for(;I<32;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}i.head&&(i.head.time=D),512&i.flags&&(V[0]=255&D,V[1]=D>>>8&255,V[2]=D>>>16&255,V[3]=D>>>24&255,i.check=a(i.check,V,4,0)),D=0,I=0,i.mode=4;case 4:for(;I<16;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}i.head&&(i.head.xflags=255&D,i.head.os=D>>8),512&i.flags&&(V[0]=255&D,V[1]=D>>>8&255,i.check=a(i.check,V,2,0)),D=0,I=0,i.mode=5;case 5:if(1024&i.flags){for(;I<16;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}i.length=D,i.head&&(i.head.extra_len=D),512&i.flags&&(V[0]=255&D,V[1]=D>>>8&255,i.check=a(i.check,V,2,0)),D=0,I=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(U=i.length,U>x&&(U=x),U&&(i.head&&(Z=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(w.subarray(A,A+U),Z)),512&i.flags&&(i.check=a(i.check,w,U,A)),x-=U,A+=U,i.length-=U),i.length))break t;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===x)break t;U=0;do{Z=w[A+U++],i.head&&Z&&i.length<65536&&(i.head.name+=String.fromCharCode(Z))}while(Z&&U<x);if(512&i.flags&&(i.check=a(i.check,w,U,A)),x-=U,A+=U,Z)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===x)break t;U=0;do{Z=w[A+U++],i.head&&Z&&i.length<65536&&(i.head.comment+=String.fromCharCode(Z))}while(Z&&U<x);if(512&i.flags&&(i.check=a(i.check,w,U,A)),x-=U,A+=U,Z)break t}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;I<16;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}if(D!==(65535&i.check)){t.msg="header crc mismatch",i.mode=S;break}D=0,I=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=v;break;case 10:for(;I<32;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}t.adler=i.check=b(D),D=0,I=0,i.mode=11;case 11:if(0===i.havedict)return t.next_out=y,t.avail_out=R,t.next_in=A,t.avail_in=x,i.hold=D,i.bits=I,c;t.adler=i.check=1,i.mode=v;case v:if(e===l||e===d)break t;case 13:if(i.last){D>>>=7&I,I-=7&I,i.mode=27;break}for(;I<3;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}switch(i.last=1&D,D>>>=1,I-=1,3&D){case 0:i.mode=14;break;case 1:if(k(i),i.mode=20,e===d){D>>>=2,I-=2;break t}break;case 2:i.mode=17;break;case 3:t.msg="invalid block type",i.mode=S}D>>>=2,I-=2;break;case 14:for(D>>>=7&I,I-=7&I;I<32;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}if((65535&D)!=(D>>>16^65535)){t.msg="invalid stored block lengths",i.mode=S;break}if(i.length=65535&D,D=0,I=0,i.mode=15,e===d)break t;case 15:i.mode=16;case 16:if(U=i.length,U){if(U>x&&(U=x),U>R&&(U=R),0===U)break t;C.set(w.subarray(A,A+U),y),x-=U,A+=U,R-=U,y+=U,i.length-=U;break}i.mode=v;break;case 17:for(;I<14;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}if(i.nlen=257+(31&D),D>>>=5,I-=5,i.ndist=1+(31&D),D>>>=5,I-=5,i.ncode=4+(15&D),D>>>=4,I-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=S;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;I<3;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}i.lens[j[i.have++]]=7&D,D>>>=3,I-=3}for(;i.have<19;)i.lens[j[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,$={bits:i.lenbits},B=o(0,i.lens,0,19,i.lencode,0,i.work,$),i.lenbits=$.bits,B){t.msg="invalid code lengths set",i.mode=S;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;K=i.lencode[D&(1<<i.lenbits)-1],P=K>>>24,L=K>>>16&255,N=65535&K,!(P<=I);){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}if(N<16)D>>>=P,I-=P,i.lens[i.have++]=N;else{if(16===N){for(W=P+2;I<W;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}if(D>>>=P,I-=P,0===i.have){t.msg="invalid bit length repeat",i.mode=S;break}Z=i.lens[i.have-1],U=3+(3&D),D>>>=2,I-=2}else if(17===N){for(W=P+3;I<W;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}D>>>=P,I-=P,Z=0,U=3+(7&D),D>>>=3,I-=3}else{for(W=P+7;I<W;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}D>>>=P,I-=P,Z=0,U=11+(127&D),D>>>=7,I-=7}if(i.have+U>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=S;break}for(;U--;)i.lens[i.have++]=Z}}if(i.mode===S)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=S;break}if(i.lenbits=9,$={bits:i.lenbits},B=o(1,i.lens,0,i.nlen,i.lencode,0,i.work,$),i.lenbits=$.bits,B){t.msg="invalid literal/lengths set",i.mode=S;break}if(i.distbits=6,i.distcode=i.distdyn,$={bits:i.distbits},B=o(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,$),i.distbits=$.bits,B){t.msg="invalid distances set",i.mode=S;break}if(i.mode=20,e===d)break t;case 20:i.mode=21;case 21:if(x>=6&&R>=258){t.next_out=y,t.avail_out=R,t.next_in=A,t.avail_in=x,i.hold=D,i.bits=I,s(t,H),y=t.next_out,C=t.output,R=t.avail_out,A=t.next_in,w=t.input,x=t.avail_in,D=i.hold,I=i.bits,i.mode===v&&(i.back=-1);break}for(i.back=0;K=i.lencode[D&(1<<i.lenbits)-1],P=K>>>24,L=K>>>16&255,N=65535&K,!(P<=I);){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}if(L&&0==(240&L)){for(M=P,z=L,Q=N;K=i.lencode[Q+((D&(1<<M+z)-1)>>M)],P=K>>>24,L=K>>>16&255,N=65535&K,!(M+P<=I);){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}D>>>=M,I-=M,i.back+=M}if(D>>>=P,I-=P,i.back+=P,i.length=N,0===L){i.mode=26;break}if(32&L){i.back=-1,i.mode=v;break}if(64&L){t.msg="invalid literal/length code",i.mode=S;break}i.extra=15&L,i.mode=22;case 22:if(i.extra){for(W=i.extra;I<W;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}i.length+=D&(1<<i.extra)-1,D>>>=i.extra,I-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;K=i.distcode[D&(1<<i.distbits)-1],P=K>>>24,L=K>>>16&255,N=65535&K,!(P<=I);){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}if(0==(240&L)){for(M=P,z=L,Q=N;K=i.distcode[Q+((D&(1<<M+z)-1)>>M)],P=K>>>24,L=K>>>16&255,N=65535&K,!(M+P<=I);){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}D>>>=M,I-=M,i.back+=M}if(D>>>=P,I-=P,i.back+=P,64&L){t.msg="invalid distance code",i.mode=S;break}i.offset=N,i.extra=15&L,i.mode=24;case 24:if(i.extra){for(W=i.extra;I<W;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}i.offset+=D&(1<<i.extra)-1,D>>>=i.extra,I-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=S;break}i.mode=25;case 25:if(0===R)break t;if(U=H-R,i.offset>U){if(U=i.offset-U,U>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=S;break}U>i.wnext?(U-=i.wnext,E=i.wsize-U):E=i.wnext-U,U>i.length&&(U=i.length),O=i.window}else O=C,E=y-i.offset,U=i.length;U>R&&(U=R),R-=U,i.length-=U;do{C[y++]=O[E++]}while(--U);0===i.length&&(i.mode=21);break;case 26:if(0===R)break t;C[y++]=i.length,R--,i.mode=21;break;case 27:if(i.wrap){for(;I<32;){if(0===x)break t;x--,D|=w[A++]<<I,I+=8}if(H-=R,t.total_out+=H,i.total+=H,H&&(t.adler=i.check=i.flags?a(i.check,C,H,y-H):n(i.check,C,H,y-H)),H=R,(i.flags?D:b(D))!==i.check){t.msg="incorrect data check",i.mode=S;break}D=0,I=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;I<32;){if(0===x)break t;x--,D+=w[A++]<<I,I+=8}if(D!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=S;break}D=0,I=0}i.mode=29;case 29:B=u;break t;case S:B=g;break t;case 31:return m;case 32:default:return _}return t.next_out=y,t.avail_out=R,t.next_in=A,t.avail_in=x,i.hold=D,i.bits=I,(i.wsize||H!==t.avail_out&&i.mode<S&&(i.mode<27||e!==r))&&F(t,t.output,t.next_out,H-t.avail_out)?(i.mode=31,m):(T-=t.avail_in,H-=t.avail_out,t.total_in+=T,t.total_out+=H,i.total+=H,i.wrap&&H&&(t.adler=i.check=i.flags?a(i.check,C,H,t.next_out-H):n(i.check,C,H,t.next_out-H)),t.data_type=i.bits+(i.last?64:0)+(i.mode===v?128:0)+(20===i.mode||15===i.mode?256:0),(0===T&&0===H||e===r)&&B===h&&(B=f),B)},t.exports.inflateEnd=t=>{if(!t||!t.state)return _;let e=t.state;return e.window&&(e.window=null),t.state=null,h},t.exports.inflateGetHeader=(t,e)=>{if(!t||!t.state)return _;const i=t.state;return 0==(2&i.wrap)?_:(i.head=e,e.done=!1,h)},t.exports.inflateSetDictionary=(t,e)=>{const i=e.length;let a,s,o;return t&&t.state?(a=t.state,0!==a.wrap&&11!==a.mode?_:11===a.mode&&(s=1,s=n(s,e,i,0),s!==a.check)?g:(o=F(t,e,i,i),o?(a.mode=31,m):(a.havedict=1,h))):_},t.exports.inflateInfo="pako inflate (from Nodeca project)"},241:t=>{"use strict";const e=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),i=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),n=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),a=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);t.exports=(t,s,o,r,l,d,h,u)=>{const c=u.bits;let _,g,m,f,p,v,S=0,b=0,w=0,C=0,A=0,y=0,x=0,R=0,D=0,I=0,k=null,F=0;const T=new Uint16Array(16),H=new Uint16Array(16);let U,E,O,P=null,L=0;for(S=0;S<=15;S++)T[S]=0;for(b=0;b<r;b++)T[s[o+b]]++;for(A=c,C=15;C>=1&&0===T[C];C--);if(A>C&&(A=C),0===C)return l[d++]=20971520,l[d++]=20971520,u.bits=1,0;for(w=1;w<C&&0===T[w];w++);for(A<w&&(A=w),R=1,S=1;S<=15;S++)if(R<<=1,R-=T[S],R<0)return-1;if(R>0&&(0===t||1!==C))return-1;for(H[1]=0,S=1;S<15;S++)H[S+1]=H[S]+T[S];for(b=0;b<r;b++)0!==s[o+b]&&(h[H[s[o+b]]++]=b);if(0===t?(k=P=h,v=19):1===t?(k=e,F-=257,P=i,L-=257,v=256):(k=n,P=a,v=-1),I=0,b=0,S=w,p=d,y=A,x=0,m=-1,D=1<<A,f=D-1,1===t&&D>852||2===t&&D>592)return 1;for(;;){U=S-x,h[b]<v?(E=0,O=h[b]):h[b]>v?(E=P[L+h[b]],O=k[F+h[b]]):(E=96,O=0),_=1<<S-x,g=1<<y,w=g;do{g-=_,l[p+(I>>x)+g]=U<<24|E<<16|O|0}while(0!==g);for(_=1<<S-1;I&_;)_>>=1;if(0!==_?(I&=_-1,I+=_):I=0,b++,0==--T[S]){if(S===C)break;S=s[o+h[b]]}if(S>A&&(I&f)!==m){for(0===x&&(x=A),p+=w,y=S-x,R=1<<y;y+x<C&&(R-=T[y+x],!(R<=0));)y++,R<<=1;if(D+=1<<y,1===t&&D>852||2===t&&D>592)return 1;m=I&f,l[m]=A<<24|y<<16|p-d|0}}return 0!==I&&(l[p+I]=S-x<<24|64<<16|0),u.bits=A,0}},898:t=>{"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},342:t=>{"use strict";function e(t){let e=t.length;for(;--e>=0;)t[e]=0}const i=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),n=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),a=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),s=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=new Array(576);e(o);const r=new Array(60);e(r);const l=new Array(512);e(l);const d=new Array(256);e(d);const h=new Array(29);e(h);const u=new Array(30);function c(t,e,i,n,a){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=a,this.has_stree=t&&t.length}let _,g,m;function f(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}e(u);const p=t=>t<256?l[t]:l[256+(t>>>7)],v=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},S=(t,e,i)=>{t.bi_valid>16-i?(t.bi_buf|=e<<t.bi_valid&65535,v(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)},b=(t,e,i)=>{S(t,i[2*e],i[2*e+1])},w=(t,e)=>{let i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1},C=(t,e,i)=>{const n=new Array(16);let a,s,o=0;for(a=1;a<=15;a++)n[a]=o=o+i[a-1]<<1;for(s=0;s<=e;s++){let e=t[2*s+1];0!==e&&(t[2*s]=w(n[e]++,e))}},A=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},y=t=>{t.bi_valid>8?v(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},x=(t,e,i,n)=>{const a=2*e,s=2*i;return t[a]<t[s]||t[a]===t[s]&&n[e]<=n[i]},R=(t,e,i)=>{const n=t.heap[i];let a=i<<1;for(;a<=t.heap_len&&(a<t.heap_len&&x(e,t.heap[a+1],t.heap[a],t.depth)&&a++,!x(e,n,t.heap[a],t.depth));)t.heap[i]=t.heap[a],i=a,a<<=1;t.heap[i]=n},D=(t,e,a)=>{let s,o,r,l,c=0;if(0!==t.last_lit)do{s=t.pending_buf[t.d_buf+2*c]<<8|t.pending_buf[t.d_buf+2*c+1],o=t.pending_buf[t.l_buf+c],c++,0===s?b(t,o,e):(r=d[o],b(t,r+256+1,e),l=i[r],0!==l&&(o-=h[r],S(t,o,l)),s--,r=p(s),b(t,r,a),l=n[r],0!==l&&(s-=u[r],S(t,s,l)))}while(c<t.last_lit);b(t,256,e)},I=(t,e)=>{const i=e.dyn_tree,n=e.stat_desc.static_tree,a=e.stat_desc.has_stree,s=e.stat_desc.elems;let o,r,l,d=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<s;o++)0!==i[2*o]?(t.heap[++t.heap_len]=d=o,t.depth[o]=0):i[2*o+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=d<2?++d:0,i[2*l]=1,t.depth[l]=0,t.opt_len--,a&&(t.static_len-=n[2*l+1]);for(e.max_code=d,o=t.heap_len>>1;o>=1;o--)R(t,i,o);l=s;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],R(t,i,1),r=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=r,i[2*l]=i[2*o]+i[2*r],t.depth[l]=(t.depth[o]>=t.depth[r]?t.depth[o]:t.depth[r])+1,i[2*o+1]=i[2*r+1]=l,t.heap[1]=l++,R(t,i,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const i=e.dyn_tree,n=e.max_code,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,r=e.stat_desc.extra_base,l=e.stat_desc.max_length;let d,h,u,c,_,g,m=0;for(c=0;c<=15;c++)t.bl_count[c]=0;for(i[2*t.heap[t.heap_max]+1]=0,d=t.heap_max+1;d<573;d++)h=t.heap[d],c=i[2*i[2*h+1]+1]+1,c>l&&(c=l,m++),i[2*h+1]=c,h>n||(t.bl_count[c]++,_=0,h>=r&&(_=o[h-r]),g=i[2*h],t.opt_len+=g*(c+_),s&&(t.static_len+=g*(a[2*h+1]+_)));if(0!==m){do{for(c=l-1;0===t.bl_count[c];)c--;t.bl_count[c]--,t.bl_count[c+1]+=2,t.bl_count[l]--,m-=2}while(m>0);for(c=l;0!==c;c--)for(h=t.bl_count[c];0!==h;)u=t.heap[--d],u>n||(i[2*u+1]!==c&&(t.opt_len+=(c-i[2*u+1])*i[2*u],i[2*u+1]=c),h--)}})(t,e),C(i,d,t.bl_count)},k=(t,e,i)=>{let n,a,s=-1,o=e[1],r=0,l=7,d=4;for(0===o&&(l=138,d=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)a=o,o=e[2*(n+1)+1],++r<l&&a===o||(r<d?t.bl_tree[2*a]+=r:0!==a?(a!==s&&t.bl_tree[2*a]++,t.bl_tree[32]++):r<=10?t.bl_tree[34]++:t.bl_tree[36]++,r=0,s=a,0===o?(l=138,d=3):a===o?(l=6,d=3):(l=7,d=4))},F=(t,e,i)=>{let n,a,s=-1,o=e[1],r=0,l=7,d=4;for(0===o&&(l=138,d=3),n=0;n<=i;n++)if(a=o,o=e[2*(n+1)+1],!(++r<l&&a===o)){if(r<d)do{b(t,a,t.bl_tree)}while(0!=--r);else 0!==a?(a!==s&&(b(t,a,t.bl_tree),r--),b(t,16,t.bl_tree),S(t,r-3,2)):r<=10?(b(t,17,t.bl_tree),S(t,r-3,3)):(b(t,18,t.bl_tree),S(t,r-11,7));r=0,s=a,0===o?(l=138,d=3):a===o?(l=6,d=3):(l=7,d=4)}};let T=!1;const H=(t,e,i,n)=>{S(t,0+(n?1:0),3),((t,e,i,n)=>{y(t),v(t,i),v(t,~i),t.pending_buf.set(t.window.subarray(e,e+i),t.pending),t.pending+=i})(t,e,i)};t.exports._tr_init=t=>{T||((()=>{let t,e,s,f,p;const v=new Array(16);for(s=0,f=0;f<28;f++)for(h[f]=s,t=0;t<1<<i[f];t++)d[s++]=f;for(d[s-1]=f,p=0,f=0;f<16;f++)for(u[f]=p,t=0;t<1<<n[f];t++)l[p++]=f;for(p>>=7;f<30;f++)for(u[f]=p<<7,t=0;t<1<<n[f]-7;t++)l[256+p++]=f;for(e=0;e<=15;e++)v[e]=0;for(t=0;t<=143;)o[2*t+1]=8,t++,v[8]++;for(;t<=255;)o[2*t+1]=9,t++,v[9]++;for(;t<=279;)o[2*t+1]=7,t++,v[7]++;for(;t<=287;)o[2*t+1]=8,t++,v[8]++;for(C(o,287,v),t=0;t<30;t++)r[2*t+1]=5,r[2*t]=w(t,5);_=new c(o,i,257,286,15),g=new c(r,n,0,30,15),m=new c(new Array(0),a,0,19,7)})(),T=!0),t.l_desc=new f(t.dyn_ltree,_),t.d_desc=new f(t.dyn_dtree,g),t.bl_desc=new f(t.bl_tree,m),t.bi_buf=0,t.bi_valid=0,A(t)},t.exports._tr_stored_block=H,t.exports._tr_flush_block=(t,e,i,n)=>{let a,l,d=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),I(t,t.l_desc),I(t,t.d_desc),d=(t=>{let e;for(k(t,t.dyn_ltree,t.l_desc.max_code),k(t,t.dyn_dtree,t.d_desc.max_code),I(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*s[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),a=t.opt_len+3+7>>>3,l=t.static_len+3+7>>>3,l<=a&&(a=l)):a=l=i+5,i+4<=a&&-1!==e?H(t,e,i,n):4===t.strategy||l===a?(S(t,2+(n?1:0),3),D(t,o,r)):(S(t,4+(n?1:0),3),((t,e,i,n)=>{let a;for(S(t,e-257,5),S(t,i-1,5),S(t,n-4,4),a=0;a<n;a++)S(t,t.bl_tree[2*s[a]+1],3);F(t,t.dyn_ltree,e-1),F(t,t.dyn_dtree,i-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,d+1),D(t,t.dyn_ltree,t.dyn_dtree)),A(t),n&&y(t)},t.exports._tr_tally=(t,e,i)=>(t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(d[i]+256+1)]++,t.dyn_dtree[2*p(e)]++),t.last_lit===t.lit_bufsize-1),t.exports._tr_align=t=>{S(t,2,3),b(t,256,o),(t=>{16===t.bi_valid?(v(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},292:t=>{"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},441:(t,e)=>{"use strict";function i(t,e,i,n){return t>i?i:t<e?e:function(t,e){return isNaN(t)?e:t}(t,n)}Object.defineProperty(e,"__esModule",{value:!0}),e.ReceivedHiFiAudioAPIData=e.HiFiAudioAPIData=e.eulerFromQuaternion=e.eulerToQuaternion=e.OrientationEuler3DOrder=e.OrientationEuler3D=e.OrientationQuat3D=e.Point3D=void 0,e.Point3D=class{constructor({x:t=0,y:e=0,z:i=0}={}){this.x=t,this.y=e,this.z=i}};class n{constructor({w:t=1,x:e=0,y:n=0,z:a=0}={}){this.w=i(t,-1,1,1),this.x=i(e,-1,1,0),this.y=i(n,-1,1,0),this.z=i(a,-1,1,0)}}function a(t){return isNaN(t)||t===1/0?0:t===-1/0?-0:t%360}e.OrientationQuat3D=n;class s{constructor({pitchDegrees:t=0,yawDegrees:e=0,rollDegrees:i=0}={}){this.pitchDegrees=a(t),this.yawDegrees=a(e),this.rollDegrees=a(i)}}var o;e.OrientationEuler3D=s,function(t){t.PitchYawRoll="PitchYawRoll",t.YawPitchRoll="YawPitchRoll",t.RollPitchYaw="RollPitchYaw",t.RollYawPitch="RollYawPitch",t.YawRollPitch="YawRollPitch",t.PitchRollYaw="PitchRollYaw"}(o=e.OrientationEuler3DOrder||(e.OrientationEuler3DOrder={})),e.eulerToQuaternion=function(t,e){const i=.5*Math.PI/180;let a=Math.cos(t.pitchDegrees*i),s=Math.cos(t.yawDegrees*i),r=Math.cos(t.rollDegrees*i),l=Math.sin(t.pitchDegrees*i),d=Math.sin(t.yawDegrees*i),h=Math.sin(t.rollDegrees*i),u=l*s*r,c=a*d*r,_=a*s*h,g=a*s*r,m=a*d*h,f=l*s*h,p=l*d*r,v=l*d*h;switch(e){case o.PitchYawRoll:return new n({x:u+m,y:c-f,z:_+p,w:g-v});case o.YawPitchRoll:return new n({x:u+m,y:c-f,z:_-p,w:g+v});case o.RollPitchYaw:return new n({x:u-m,y:c+f,z:_+p,w:g-v});case o.RollYawPitch:return new n({x:u-m,y:c+f,z:_-p,w:g+v});case o.YawRollPitch:return new n({x:u+m,y:c+f,z:_-p,w:g-v});case o.PitchRollYaw:return new n({x:u-m,y:c-f,z:_+p,w:g+v})}},e.eulerFromQuaternion=function(t,e){let i=t.x*t.x,n=t.y*t.y,a=t.z*t.z,r=t.w*t.x,l=t.w*t.y,d=t.w*t.z,h=t.x*t.y,u=t.y*t.z,c=t.z*t.x,_=1-2*(n+a),g=2*(h+d),m=2*(c-l),f=2*(h-d),p=1-2*(i+a),v=2*(u+r),S=2*(c+l),b=2*(u-r),w=1-2*(i+n),C=0,A=0,y=0;const x=.9999999;switch(e){case o.PitchYawRoll:A=Math.asin(S),Math.abs(S)<x?(C=Math.atan2(-b,w),y=Math.atan2(-f,_)):C=Math.atan2(v,p);break;case o.YawPitchRoll:C=Math.asin(-b),Math.abs(b)<x?(A=Math.atan2(S,w),y=Math.atan2(g,p)):A=Math.atan2(-m,_);break;case o.RollPitchYaw:C=Math.asin(v),Math.abs(v)<x?(A=Math.atan2(-m,w),y=Math.atan2(-f,p)):y=Math.atan2(g,_);break;case o.RollYawPitch:A=Math.asin(-m),Math.abs(m)<x?(C=Math.atan2(v,w),y=Math.atan2(g,_)):y=Math.atan2(-f,p);break;case o.YawRollPitch:y=Math.asin(g),Math.abs(g)<x?(C=Math.atan2(-b,p),A=Math.atan2(-m,_)):A=Math.atan2(S,w);break;case o.PitchRollYaw:y=Math.asin(-f),Math.abs(f)<x?(C=Math.atan2(v,p),A=Math.atan2(S,_)):A=Math.atan2(-b,w)}const R=180/Math.PI;return new s({pitchDegrees:R*C,yawDegrees:R*A,rollDegrees:R*y})};class r{constructor({position:t=null,orientationQuat:e=null,orientationEuler:i=null,volumeThreshold:n=null,hiFiGain:a=null,userAttenuation:s=null,userRolloff:o=null}={}){this.position=t,this.orientationQuat=e,this.orientationEuler=i,this.volumeThreshold=n,this.hiFiGain=a,this.userAttenuation=s,this.userRolloff=o}}e.HiFiAudioAPIData=r,e.ReceivedHiFiAudioAPIData=class extends r{constructor(t={}){super(t),this.providedUserID=t.providedUserID,this.hashedVisitID=t.hashedVisitID,this.volumeDecibels=t.volumeDecibels}}},641:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HiFiAxisUtilities=e.ourHiFiAxisConfiguration=e.HiFiAxisConfiguration=e.HiFiHandedness=e.HiFiAxes=void 0;const n=i(649),a=i(441);var s,o;!function(t){t.PositiveX="Positive X",t.NegativeX="Negative X",t.PositiveY="Positive Y",t.NegativeY="Negative Y",t.PositiveZ="Positive Z",t.NegativeZ="Negative Z"}(s=e.HiFiAxes||(e.HiFiAxes={})),function(t){t.RightHand="Right Hand",t.LeftHand="Left Hand"}(o=e.HiFiHandedness||(e.HiFiHandedness={}));class r{constructor({rightAxis:t,leftAxis:e,intoScreenAxis:i,outOfScreenAxis:n,upAxis:a,downAxis:s,handedness:o,eulerOrder:r}){Object.assign(this,{rightAxis:t,leftAxis:e,intoScreenAxis:i,outOfScreenAxis:n,upAxis:a,downAxis:s,handedness:o,eulerOrder:r})}}e.HiFiAxisConfiguration=r,e.ourHiFiAxisConfiguration=new r({rightAxis:s.PositiveX,leftAxis:s.NegativeX,intoScreenAxis:s.PositiveY,outOfScreenAxis:s.NegativeY,upAxis:s.PositiveZ,downAxis:s.NegativeZ,handedness:o.RightHand,eulerOrder:a.OrientationEuler3DOrder.YawPitchRoll}),e.HiFiAxisUtilities=class{static verify(t){let e=!0;return t.rightAxis===s.PositiveX&&t.leftAxis!==s.NegativeX&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.rightAxis}, and Left Axis is ${t.leftAxis}!`),e=!1),t.leftAxis===s.PositiveX&&t.rightAxis!==s.NegativeX&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.rightAxis}, and Left Axis is ${t.leftAxis}!`),e=!1),t.rightAxis===s.PositiveY&&t.leftAxis!==s.NegativeY&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.rightAxis}, and Left Axis is ${t.leftAxis}!`),e=!1),t.leftAxis===s.PositiveY&&t.rightAxis!==s.NegativeY&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.rightAxis}, and Left Axis is ${t.leftAxis}!`),e=!1),t.rightAxis===s.PositiveZ&&t.leftAxis!==s.NegativeZ&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.rightAxis}, and Left Axis is ${t.leftAxis}!`),e=!1),t.leftAxis===s.PositiveZ&&t.rightAxis!==s.NegativeZ&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.rightAxis}, and Left Axis is ${t.leftAxis}!`),e=!1),t.intoScreenAxis===s.PositiveX&&t.outOfScreenAxis!==s.NegativeX&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.intoScreenAxis}, and Left Axis is ${t.outOfScreenAxis}!`),e=!1),t.outOfScreenAxis===s.PositiveX&&t.intoScreenAxis!==s.NegativeX&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.intoScreenAxis}, and Left Axis is ${t.outOfScreenAxis}!`),e=!1),t.intoScreenAxis===s.PositiveY&&t.outOfScreenAxis!==s.NegativeY&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.intoScreenAxis}, and Left Axis is ${t.outOfScreenAxis}!`),e=!1),t.outOfScreenAxis===s.PositiveY&&t.intoScreenAxis!==s.NegativeY&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.intoScreenAxis}, and Left Axis is ${t.outOfScreenAxis}!`),e=!1),t.intoScreenAxis===s.PositiveZ&&t.outOfScreenAxis!==s.NegativeZ&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.intoScreenAxis}, and Left Axis is ${t.outOfScreenAxis}!`),e=!1),t.outOfScreenAxis===s.PositiveZ&&t.intoScreenAxis!==s.NegativeZ&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.intoScreenAxis}, and Left Axis is ${t.outOfScreenAxis}!`),e=!1),t.upAxis===s.PositiveX&&t.downAxis!==s.NegativeX&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.upAxis}, and Left Axis is ${t.downAxis}!`),e=!1),t.downAxis===s.PositiveX&&t.upAxis!==s.NegativeX&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.upAxis}, and Left Axis is ${t.downAxis}!`),e=!1),t.upAxis===s.PositiveY&&t.downAxis!==s.NegativeY&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.upAxis}, and Left Axis is ${t.downAxis}!`),e=!1),t.downAxis===s.PositiveY&&t.upAxis!==s.NegativeY&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.upAxis}, and Left Axis is ${t.downAxis}!`),e=!1),t.upAxis===s.PositiveZ&&t.downAxis!==s.NegativeZ&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.upAxis}, and Left Axis is ${t.downAxis}!`),e=!1),t.downAxis===s.PositiveZ&&t.upAxis!==s.NegativeZ&&(n.HiFiLogger.error(`Invalid axis configuration!\nRight Axis is ${t.upAxis}, and Left Axis is ${t.downAxis}!`),e=!1),t.handedness!==o.RightHand&&t.handedness!==o.LeftHand&&(n.HiFiLogger.error(`Invalid axis configuration!\nHandedness is ${t.handedness}!`),e=!1),e}static translatePoint3DToMixerSpace(t,e){let i=new a.Point3D;return i=e,i}static translatePoint3DFromMixerSpace(t,e){let i=new a.Point3D;return i=e,i}static translateOrientationQuat3DToMixerSpace(t,e){let i=new a.OrientationQuat3D;return i=e,i}static translateOrientationQuat3DFromMixerSpace(t,e){let i=new a.OrientationQuat3D;return i=e,i}}},468:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function r(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,r)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.HiFiCommunicator=e.HiFiUserDataStreamingScopes=e.HiFiConnectionStates=void 0;const a=i(709),s=i(649),o=i(441),r=i(641),l=i(971),d=i(817);var h,u;(u=e.HiFiConnectionStates||(e.HiFiConnectionStates={})).Connected="Connected",u.Disconnected="Disconnected",u.Failed="Failed",u.Unavailable="Unavailable",function(t){t.None="none",t.Peers="peers",t.All="all"}(h=e.HiFiUserDataStreamingScopes||(e.HiFiUserDataStreamingScopes={})),e.HiFiCommunicator=class{constructor({initialHiFiAudioAPIData:t=new o.HiFiAudioAPIData,onConnectionStateChanged:e,onUsersDisconnected:i,transmitRateLimitTimeoutMS:n=a.HiFiConstants.DEFAULT_TRANSMIT_RATE_LIMIT_TIMEOUT_MS,userDataStreamingScope:d=h.All,hiFiAxisConfiguration:u}={}){this._timers={transmitRateLimitTimeout:null,wantedToTransmitHiFiAudioAPIData:!0},n<a.HiFiConstants.MIN_TRANSMIT_RATE_LIMIT_TIMEOUT_MS&&(s.HiFiLogger.warn(`\`transmitRateLimitTimeoutMS\` must be >= ${a.HiFiConstants.MIN_TRANSMIT_RATE_LIMIT_TIMEOUT_MS}ms! Setting to ${a.HiFiConstants.MIN_TRANSMIT_RATE_LIMIT_TIMEOUT_MS}ms...`),n=a.HiFiConstants.MIN_TRANSMIT_RATE_LIMIT_TIMEOUT_MS),this.transmitRateLimitTimeoutMS=n,i&&(this.onUsersDisconnected=i),this._mixerSession=new l.HiFiMixerSession({userDataStreamingScope:d,onUserDataUpdated:t=>{this._handleUserDataUpdates(t)},onUsersDisconnected:t=>{this._onUsersDisconnected(t)},onConnectionStateChanged:e}),this._inputAudioMediaStream=void 0,this._currentHiFiAudioAPIData=new o.HiFiAudioAPIData,this._lastTransmittedHiFiAudioAPIData=new o.HiFiAudioAPIData,this._userDataSubscriptions=[],u&&(r.HiFiAxisUtilities.verify(u)?(r.ourHiFiAxisConfiguration.rightAxis=u.rightAxis,r.ourHiFiAxisConfiguration.leftAxis=u.leftAxis,r.ourHiFiAxisConfiguration.intoScreenAxis=u.intoScreenAxis,r.ourHiFiAxisConfiguration.outOfScreenAxis=u.outOfScreenAxis,r.ourHiFiAxisConfiguration.upAxis=u.upAxis,r.ourHiFiAxisConfiguration.downAxis=u.downAxis,r.ourHiFiAxisConfiguration.handedness=u.handedness):s.HiFiLogger.error("There is an error with the passed `HiFiAxisConfiguration`, so the new axis configuration was not set. There are more error details in the logs above.")),this._updateUserData(t)}connectToHiFiAudioAPIServer(t,e){return n(this,void 0,void 0,(function*(){if(!this._mixerSession){let t="`this._mixerSession` is falsey!";return Promise.reject({success:!1,error:t})}let i,n;try{n=new URL(e).hostname}catch(t){n=e||a.HiFiConstants.DEFAULT_PROD_HIGH_FIDELITY_ENDPOINT}try{let e=`wss://${n}:8001/?token=`;this._mixerSession.webRTCAddress=`${e}${t}`,s.HiFiLogger.log(`Using WebRTC Signaling Address:\n${e}<token redacted>`),i=yield this._mixerSession.connect()}catch(t){let e=`Error when connecting to mixer! Error:\n${t}`;return Promise.reject({success:!1,error:e})}return this._transmitHiFiAudioAPIDataToServer(!0),Promise.resolve({success:!0,audionetInitResponse:i.audionetInitResponse})}))}disconnectFromHiFiAudioAPIServer(){return n(this,void 0,void 0,(function*(){return this._mixerSession?(this._inputAudioMediaStream=void 0,this.onUsersDisconnected=void 0,this._userDataSubscriptions=[],this._currentHiFiAudioAPIData=void 0,this._lastTransmittedHiFiAudioAPIData=new o.HiFiAudioAPIData,this._mixerSession.disconnect()):Promise.resolve("No mixer session from which we can disconnect!")}))}getOutputAudioMediaStream(){return this._mixerSession?this._mixerSession.getOutputAudioMediaStream():null}setInputAudioMediaStream(t,e=!1){return n(this,void 0,void 0,(function*(){const i=yield this._mixerSession.setRAVIInputAudio(t,e);return i?this._inputAudioMediaStream=t:s.HiFiLogger.warn("Error trying to setRAVIInputAudio on this._mixerSession"),i}))}setInputAudioMuted(t){return n(this,void 0,void 0,(function*(){return this._mixerSession?(s.HiFiLogger.debug(`Setting mute state to : ${t}`),yield this._mixerSession.setInputAudioMuted(t)):(s.HiFiLogger.warn("Couldn't set mute state: No `_mixerSession`."),!1)}))}getCommunicatorInfo(){let t={clientInfo:{inputAudioStreamSet:!!this._inputAudioMediaStream}};return"undefined"!=typeof self&&(t.clientInfo.apiVersion="v0.4.3"),this._mixerSession&&this._mixerSession.mixerInfo&&(t.serverInfo=this._mixerSession.mixerInfo),t}startCollectingWebRTCStats(t){this._mixerSession||s.HiFiLogger.error("Couldn't start collecting WebRTC Stats: No `_mixerSession`!"),this._mixerSession.startCollectingWebRTCStats(t)}stopCollectingWebRTCStats(){this._mixerSession||s.HiFiLogger.error("Couldn't stop collecting WebRTC Stats: No `_mixerSession`!"),this._mixerSession.stopCollectingWebRTCStats()}_updateUserData({position:t,orientationQuat:e,orientationEuler:i,volumeThreshold:n,hiFiGain:a,userAttenuation:s,userRolloff:l}={}){var d,h,u,c,_,g,m;if(t&&(this._currentHiFiAudioAPIData.position||(this._currentHiFiAudioAPIData.position=new o.Point3D),this._currentHiFiAudioAPIData.position.x=null!==(d=t.x)&&void 0!==d?d:this._currentHiFiAudioAPIData.position.x,this._currentHiFiAudioAPIData.position.y=null!==(h=t.y)&&void 0!==h?h:this._currentHiFiAudioAPIData.position.y,this._currentHiFiAudioAPIData.position.z=null!==(u=t.z)&&void 0!==u?u:this._currentHiFiAudioAPIData.position.z),e)this._currentHiFiAudioAPIData.orientationQuat||(this._currentHiFiAudioAPIData.orientationQuat=new o.OrientationQuat3D),this._currentHiFiAudioAPIData.orientationQuat.w=null!==(c=e.w)&&void 0!==c?c:this._currentHiFiAudioAPIData.orientationQuat.w,this._currentHiFiAudioAPIData.orientationQuat.x=null!==(_=e.x)&&void 0!==_?_:this._currentHiFiAudioAPIData.orientationQuat.x,this._currentHiFiAudioAPIData.orientationQuat.y=null!==(g=e.y)&&void 0!==g?g:this._currentHiFiAudioAPIData.orientationQuat.y,this._currentHiFiAudioAPIData.orientationQuat.z=null!==(m=e.z)&&void 0!==m?m:this._currentHiFiAudioAPIData.orientationQuat.z;else if(i){let t=new o.OrientationEuler3D(i);this._currentHiFiAudioAPIData.orientationQuat=o.eulerToQuaternion(t,r.ourHiFiAxisConfiguration.eulerOrder)}"number"==typeof n&&(this._currentHiFiAudioAPIData.volumeThreshold=n),"number"==typeof a&&(this._currentHiFiAudioAPIData.hiFiGain=Math.max(0,a)),"number"==typeof s&&(this._currentHiFiAudioAPIData.userAttenuation=s),"number"==typeof l&&(this._currentHiFiAudioAPIData.userRolloff=Math.max(0,l))}_maybeClearRateLimitTimeout(){this._timers.transmitRateLimitTimeout&&clearTimeout(this._timers.transmitRateLimitTimeout),this._timers.transmitRateLimitTimeout=null}_updateLastTransmittedHiFiAudioAPIData(t){var e,i,n,a,s,r,l;t.position&&(this._lastTransmittedHiFiAudioAPIData.position||(this._lastTransmittedHiFiAudioAPIData.position=new o.Point3D),this._lastTransmittedHiFiAudioAPIData.position.x=null!==(e=t.position.x)&&void 0!==e?e:this._lastTransmittedHiFiAudioAPIData.position.x,this._lastTransmittedHiFiAudioAPIData.position.y=null!==(i=t.position.y)&&void 0!==i?i:this._lastTransmittedHiFiAudioAPIData.position.y,this._lastTransmittedHiFiAudioAPIData.position.z=null!==(n=t.position.z)&&void 0!==n?n:this._lastTransmittedHiFiAudioAPIData.position.z),t.orientationQuat&&(this._lastTransmittedHiFiAudioAPIData.orientationQuat||(this._lastTransmittedHiFiAudioAPIData.orientationQuat=new o.OrientationQuat3D),this._lastTransmittedHiFiAudioAPIData.orientationQuat.w=null!==(a=t.orientationQuat.w)&&void 0!==a?a:this._lastTransmittedHiFiAudioAPIData.orientationQuat.w,this._lastTransmittedHiFiAudioAPIData.orientationQuat.x=null!==(s=t.orientationQuat.x)&&void 0!==s?s:this._lastTransmittedHiFiAudioAPIData.orientationQuat.x,this._lastTransmittedHiFiAudioAPIData.orientationQuat.y=null!==(r=t.orientationQuat.y)&&void 0!==r?r:this._lastTransmittedHiFiAudioAPIData.orientationQuat.y,this._lastTransmittedHiFiAudioAPIData.orientationQuat.z=null!==(l=t.orientationQuat.z)&&void 0!==l?l:this._lastTransmittedHiFiAudioAPIData.orientationQuat.z),"number"==typeof t.volumeThreshold&&(this._lastTransmittedHiFiAudioAPIData.volumeThreshold=t.volumeThreshold),"number"==typeof t.hiFiGain&&(this._lastTransmittedHiFiAudioAPIData.hiFiGain=t.hiFiGain),"number"==typeof t.userAttenuation&&(this._lastTransmittedHiFiAudioAPIData.userAttenuation=t.userAttenuation),"number"==typeof t.userRolloff&&(this._lastTransmittedHiFiAudioAPIData.userRolloff=t.userRolloff)}_transmitHiFiAudioAPIDataToServer(t){if(this._mixerSession&&(!this._timers.transmitRateLimitTimeout||t)){this._timers.wantedToTransmitHiFiAudioAPIData=!1,this._maybeClearRateLimitTimeout(),t||(this._timers.transmitRateLimitTimeout=setTimeout((()=>{this._maybeClearRateLimitTimeout(),this._timers.wantedToTransmitHiFiAudioAPIData&&this._transmitHiFiAudioAPIDataToServer(!0)}),this.transmitRateLimitTimeoutMS));let e=this._mixerSession._transmitHiFiAudioAPIDataToServer(this._currentHiFiAudioAPIData,this._lastTransmittedHiFiAudioAPIData);return e.success?(this._updateLastTransmittedHiFiAudioAPIData(this._currentHiFiAudioAPIData),{success:!0,rawDataTransmitted:e.stringifiedDataForMixer}):{success:!1,error:e.error}}return this._mixerSession&&this._timers.transmitRateLimitTimeout&&!t?(this._timers.wantedToTransmitHiFiAudioAPIData=!0,{success:!0,error:"Transfer is rate limited. Transfer will occur shortly automatically."}):this._mixerSession?void 0:{success:!1,error:"No server connection yet; can't transmit user data."}}updateUserDataAndTransmit(t){return this._updateUserData(t),this._transmitHiFiAudioAPIDataToServer()}_handleUserDataUpdates(t){if(0!==this._userDataSubscriptions.length)for(let e=0;e<this._userDataSubscriptions.length;e++){let i=this._userDataSubscriptions[e];if(!i.callback)continue;let n=[];for(let e=0;e<t.length;e++){let a=t[e];if(i.providedUserID&&a.providedUserID!==i.providedUserID)continue;let s=new o.ReceivedHiFiAudioAPIData;"string"==typeof a.providedUserID&&(s.providedUserID=a.providedUserID),"string"==typeof a.hashedVisitID&&(s.hashedVisitID=a.hashedVisitID);let l=!1;for(let t=0;t<i.components.length;t++)switch(i.components[t]){case d.AvailableUserDataSubscriptionComponents.Position:a.position&&(s.position=a.position,l=!0);break;case d.AvailableUserDataSubscriptionComponents.OrientationQuat:a.orientationQuat&&(s.orientationQuat=a.orientationQuat,l=!0);break;case d.AvailableUserDataSubscriptionComponents.OrientationEuler:a.orientationQuat&&(s.orientationEuler=o.eulerFromQuaternion(a.orientationQuat,r.ourHiFiAxisConfiguration.eulerOrder),l=!0);break;case d.AvailableUserDataSubscriptionComponents.VolumeDecibels:"number"==typeof a.volumeDecibels&&(s.volumeDecibels=a.volumeDecibels,l=!0);break;case d.AvailableUserDataSubscriptionComponents.HiFiGain:"number"==typeof a.hiFiGain&&(s.hiFiGain=a.hiFiGain,l=!0)}l&&n.push(s)}i.callback&&n.length>0&&i.callback(n)}}_onUsersDisconnected(t){this.onUsersDisconnected&&this.onUsersDisconnected(t)}addUserDataSubscription(t){this._mixerSession?this._mixerSession.userDataStreamingScope!==h.None?(s.HiFiLogger.log(`Adding new User Data Subscription:\n${JSON.stringify(t)}`),this._userDataSubscriptions.push(t)):s.HiFiLogger.error("During `HiFiCommunicator` construction, the server was set up to **not** send user data! Data subscription not added."):s.HiFiLogger.error("No `_mixerSession`! Data subscription not added.")}}},971:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function r(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,r)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.HiFiMixerSession=void 0;const a=i(441),s=i(649),o=i(468),r=i(425),l=i(665),d=i(212),h=i(641),u=i(591);e.HiFiMixerSession=class{constructor({userDataStreamingScope:t=o.HiFiUserDataStreamingScopes.All,onUserDataUpdated:e,onUsersDisconnected:i,onConnectionStateChanged:n}){this.webRTCAddress=void 0,this.userDataStreamingScope=t,this.onUserDataUpdated=e,this.onUsersDisconnected=i,this._mixerPeerKeyToStateCacheDict={},r.RaviUtils.setDebug(!1),this._raviSignalingConnection=new d.RaviSignalingConnection,this._raviSignalingConnection.addStateChangeHandler((t=>{this.onRAVISignalingStateChanged(t)})),this._raviSession=new l.RaviSession,this._raviSession.addStateChangeHandler((t=>{this.onRAVISessionStateChanged(t)})),this.onConnectionStateChanged=n,this._resetMixerInfo()}promiseToRunAudioInit(){return n(this,void 0,void 0,(function*(){return new Promise(((t,e)=>{let i={primary:!0,visit_id:this._raviSession.getUUID(),session:this._raviSession.getUUID(),streaming_scope:this.userDataStreamingScope,is_input_stream_stereo:this._inputAudioMediaStreamIsStereo},a=this._raviSession.getCommandController();if(!a)return Promise.reject({success:!1,error:"Couldn't connect to mixer: no `commandController`!"});let s=setTimeout((()=>(this.disconnect(),Promise.reject({success:!1,error:"Couldn't connect to mixer: Call to `init` timed out!"}))),5e3);a.queueCommand("audionet.init",i,(i=>n(this,void 0,void 0,(function*(){let n;clearTimeout(s);try{n=JSON.parse(i),this.mixerInfo.connected=!0,this.mixerInfo.build_number=n.build_number,this.mixerInfo.build_type=n.build_type,this.mixerInfo.build_version=n.build_version,this.mixerInfo.visit_id_hash=n.visit_id_hash,n.unhashedVisitID=this._raviSession.getUUID(),t({success:!0,audionetInitResponse:n})}catch(t){e({success:!1,error:`Couldn't parse init response! Parse error:\n${t}`})}}))))}))}))}handleRAVISessionBinaryData(t){let e=u.ungzip(t,{to:"string"}),i=JSON.parse(e);if(i.deleted_visit_ids){let t=[],e=i.deleted_visit_ids;for(const i of e){let e=i,n=new a.ReceivedHiFiAudioAPIData({hashedVisitID:e}),s=Object.keys(this._mixerPeerKeyToStateCacheDict);for(const t of s)if(this._mixerPeerKeyToStateCacheDict[t].hashedVisitID===e){this._mixerPeerKeyToStateCacheDict[t].providedUserID&&(n.providedUserID=this._mixerPeerKeyToStateCacheDict[t].providedUserID);break}t.push(n)}this.onUsersDisconnected&&t.length>0&&this.onUsersDisconnected(t)}if(i.peers){let t=[],e=Object.keys(i.peers);for(let n=0;n<e.length;n++){let s,o=i.peers[e[n]];this._mixerPeerKeyToStateCacheDict[e[n]]?s=this._mixerPeerKeyToStateCacheDict[e[n]]:(s=new a.ReceivedHiFiAudioAPIData,this._mixerPeerKeyToStateCacheDict[e[n]]=s);let r=new a.ReceivedHiFiAudioAPIData;s.providedUserID?r.providedUserID=s.providedUserID:"string"==typeof o.J&&(s.providedUserID=o.J,r.providedUserID=o.J),s.hashedVisitID?r.hashedVisitID=s.hashedVisitID:"string"==typeof o.e&&(s.hashedVisitID=o.e,r.hashedVisitID=o.e);let l=!1,d=!1;"number"==typeof o.x&&(s.position||(s.position=new a.Point3D),s.position.x=o.x/1e3,d=!0),"number"==typeof o.y&&(s.position||(s.position=new a.Point3D),s.position.y=o.y/1e3,d=!0),"number"==typeof o.z&&(s.position||(s.position=new a.Point3D),s.position.z=o.z/1e3,d=!0),d&&(r.position=h.HiFiAxisUtilities.translatePoint3DFromMixerSpace(h.ourHiFiAxisConfiguration,s.position),l=!0);let u=!1;"number"==typeof o.W&&(s.orientationQuat||(s.orientationQuat=new a.OrientationQuat3D),s.orientationQuat.w=o.W/1e3,u=!0),"number"==typeof o.X&&(s.orientationQuat||(s.orientationQuat=new a.OrientationQuat3D),s.orientationQuat.x=o.X/1e3,u=!0),"number"==typeof o.Y&&(s.orientationQuat||(s.orientationQuat=new a.OrientationQuat3D),s.orientationQuat.y=o.Y/1e3,u=!0),"number"==typeof o.Z&&(s.orientationQuat||(s.orientationQuat=new a.OrientationQuat3D),s.orientationQuat.z=o.Z/1e3,u=!0),u&&(r.orientationQuat=h.HiFiAxisUtilities.translateOrientationQuat3DFromMixerSpace(h.ourHiFiAxisConfiguration,s.orientationQuat),l=!0),"number"==typeof o.g&&(s.hiFiGain=o.g,r.hiFiGain=o.g,l=!0),"number"==typeof o.v&&(s.volumeDecibels=o.v,r.volumeDecibels=o.v,l=!0),l&&t.push(r)}this.onUserDataUpdated&&t.length>0&&this.onUserDataUpdated(t)}}connect(){return n(this,void 0,void 0,(function*(){if(!this.webRTCAddress){let t="Couldn't connect: `this.webRTCAddress` is falsey!";return this.disconnect(),Promise.reject(t)}this._currentHiFiConnectionState=void 0;try{yield this._raviSignalingConnection.open(this.webRTCAddress)}catch(t){let e=`Couldn't open signaling connection to \`${this.webRTCAddress.slice(0,this.webRTCAddress.indexOf("token="))}<token redacted>\`! Error:\n${t}`;return this.disconnect(),Promise.reject(e)}try{yield this._raviSession.open(this._raviSignalingConnection)}catch(t){let e=`Couldn't open RAVI session associated with \`${this.webRTCAddress.slice(0,this.webRTCAddress.indexOf("token="))}<token redacted>\`! Error:\n${t}`;return this.disconnect(),Promise.reject(e)}let t;try{t=yield this.promiseToRunAudioInit()}catch(t){let e=`\`audionet.init\` command failed! Error:\n${t.error}`;return this.disconnect(),Promise.reject(e)}return this._raviSession.getCommandController().addBinaryHandler((t=>{this.handleRAVISessionBinaryData(t)}),!0),Promise.resolve(t)}))}disconnect(){return n(this,void 0,void 0,(function*(){function t(t,e,i){return n(this,void 0,void 0,(function*(){if(t){let n=t.getState();if(t&&n!==i)try{yield t.close(),s.HiFiLogger.log(`The RAVI ${e} closed successfully from state ${n}.`)}catch(t){s.HiFiLogger.warn(`The RAVI ${e} didn't close successfully from state ${n}! Error:\n${t}`)}else s.HiFiLogger.log(`The RAVI ${e} was already closed.`)}else s.HiFiLogger.warn(`The RAVI ${e} was missing.`);t=null}))}return yield t(this._raviSignalingConnection,"Signaling Connection",d.RaviSignalingStates.CLOSED),yield t(this._raviSession,"Session",l.RaviSessionStates.CLOSED),this._resetMixerInfo(),Promise.resolve("Successfully disconnected.")}))}setRAVIInputAudio(t,e=!1){return n(this,void 0,void 0,(function*(){let i=!1;if(this._raviSession){let n=this._raviSession.getStreamController();n?(n.setInputAudio(t,e),s.HiFiLogger.log("Successfully set input audio on _raviSession.streamController!"),i=!0):(s.HiFiLogger.warn("Couldn't set input audio on _raviSession.streamController: No `streamController`!"),i=!1)}else s.HiFiLogger.warn("Couldn't set input audio on _raviSession.streamController: No `_raviSession`!"),i=!1;if(i&&this._inputAudioMediaStreamIsStereo!=e)if(this._raviSession.getState()===l.RaviSessionStates.CONNECTED){let t;s.HiFiLogger.warn(`Stereo status has changed from ${this._inputAudioMediaStreamIsStereo} to ${e}; attempting to re-initialize with the mixer`);try{this._inputAudioMediaStreamIsStereo=e,t=yield this.promiseToRunAudioInit()}catch(t){let e=`Attempt to call \`audionet.init\` for change in stereo status failed! Error:\n${t.error}`;return Promise.reject(e)}}else this._inputAudioMediaStreamIsStereo=e;return i}))}setInputAudioMuted(t,e=!1){return n(this,void 0,void 0,(function*(){let i=this._raviSession.getStreamController();if(!this._raviSession||!i)return s.HiFiLogger.warn("Couldn't set mute state: No `_raviSession`, or `_raviSession.getStreamController()` returned null."),!1;{let n=!1;if(navigator.permissions&&navigator.permissions.query){let t;try{t=yield navigator.permissions.query({name:"microphone"})}catch(t){}t&&"granted"===t.state&&(n=!0)}if(e&&n&&"undefined"!=typeof self){let e=i._inputAudioStream;if(e&&t)return e.getTracks().forEach((t=>{this._cachedMediaTrackConstraints=t.getConstraints(),t.stop()})),i.setInputAudio(null),s.HiFiLogger.log("Successfully set mute state to `true` by stopping all input media tracks!"),!0;if(!e&&!t){let t=yield navigator.mediaDevices.getUserMedia({audio:this._cachedMediaTrackConstraints,video:!1});return i.setInputAudio(t),s.HiFiLogger.log("Successfully set mute state to `false` by getting new input media stream!"),!0}if(e&&!t)return e.getTracks().forEach((t=>{t.enabled=!0})),s.HiFiLogger.log("Successfully set mute state to `false` by enabling all tracks on `_raviSession.streamController._inputAudioStream`!"),!0;s.HiFiLogger.warn("Couldn't set mute state: No `_inputAudioStream` on `_raviSession.streamController`.")}else{let e=i._inputAudioStream;if(e)return e.getTracks().forEach((e=>{e.enabled=!t})),s.HiFiLogger.log(`Successfully set mute state to ${t} on _raviSession.streamController._inputAudioStream`),!0;s.HiFiLogger.warn("Couldn't set mute state: No `_inputAudioStream` on `_raviSession.streamController`.")}}}))}getOutputAudioMediaStream(){if(!this._raviSession)return null;let t=this._raviSession.getStreamController();return t?t.getAudioStream():null}onRAVISignalingStateChanged(t){switch(s.HiFiLogger.log(`New RAVI signaling state: \`${t.state}\``),t.state){case d.RaviSignalingStates.UNAVAILABLE:this._currentHiFiConnectionState=o.HiFiConnectionStates.Unavailable,this.onConnectionStateChanged&&this.onConnectionStateChanged(this._currentHiFiConnectionState),this.disconnect()}}onRAVISessionStateChanged(t){switch(s.HiFiLogger.log(`New RAVI session state: \`${t.state}\``),t.state){case l.RaviSessionStates.CONNECTED:this._mixerPeerKeyToStateCacheDict={},this._currentHiFiConnectionState=o.HiFiConnectionStates.Connected,this.onConnectionStateChanged&&this.onConnectionStateChanged(this._currentHiFiConnectionState);break;case l.RaviSessionStates.DISCONNECTED:if(this._currentHiFiConnectionState===o.HiFiConnectionStates.Unavailable)break;this._currentHiFiConnectionState=o.HiFiConnectionStates.Disconnected,this.onConnectionStateChanged&&this.onConnectionStateChanged(this._currentHiFiConnectionState);break;case l.RaviSessionStates.FAILED:if(this._currentHiFiConnectionState===o.HiFiConnectionStates.Unavailable)break;this._currentHiFiConnectionState=o.HiFiConnectionStates.Failed,this.onConnectionStateChanged&&this.onConnectionStateChanged(this._currentHiFiConnectionState)}}startCollectingWebRTCStats(t){this._raviSession?(this._statsObserverCallback&&this.stopCollectingWebRTCStats(),this._statsObserverCallback=t,this._raviSession.addStatsObserver(this._statsObserverCallback)):s.HiFiLogger.error("Couldn't start collecting WebRTC stats: No `_raviSession`!")}stopCollectingWebRTCStats(){this._raviSession?(this._raviSession.removeStatsObserver(this._statsObserverCallback),this._statsObserverCallback=void 0):s.HiFiLogger.error("Couldn't stop collecting WebRTC stats: No `_raviSession`!")}_transmitHiFiAudioAPIDataToServer(t,e){if(!this.mixerInfo.connected||!this._raviSession)return{success:!1,error:"Can't transmit data to mixer; not connected to mixer."};let i={};if(t.position&&"number"==typeof t.position.x&&"number"==typeof t.position.y&&"number"==typeof t.position.z){let n={x:!1,y:!1,z:!1,changed:!1};if(e&&e.position?(t.position.x!==e.position.x&&(n.x=!0,n.changed=!0),t.position.y!==e.position.y&&(n.y=!0,n.changed=!0),t.position.z!==e.position.z&&(n.z=!0,n.changed=!0)):(n.x=!0,n.y=!0,n.z=!0,n.changed=!0),n.changed){let e=h.HiFiAxisUtilities.translatePoint3DToMixerSpace(h.ourHiFiAxisConfiguration,t.position);n.x&&(i.x=Math.round(1e3*e.x)),n.y&&(i.y=Math.round(1e3*e.y)),n.z&&(i.z=Math.round(1e3*e.z))}}if(t.orientationQuat&&"number"==typeof t.orientationQuat.w&&"number"==typeof t.orientationQuat.x&&"number"==typeof t.orientationQuat.y&&"number"==typeof t.orientationQuat.z){let n={w:!1,x:!1,y:!1,z:!1,changed:!1};if(e&&e.orientationQuat?(t.orientationQuat.w!==e.orientationQuat.w&&(n.w=!0,n.changed=!0),t.orientationQuat.x!==e.orientationQuat.x&&(n.x=!0,n.changed=!0),t.orientationQuat.y!==e.orientationQuat.y&&(n.y=!0,n.changed=!0),t.orientationQuat.z!==e.orientationQuat.z&&(n.z=!0,n.changed=!0)):(n.w=!0,n.x=!0,n.y=!0,n.z=!0,n.changed=!0),n.changed){let e=h.HiFiAxisUtilities.translateOrientationQuat3DToMixerSpace(h.ourHiFiAxisConfiguration,t.orientationQuat);n.w&&(i.W=1e3*e.w),n.x&&(i.X=1e3*e.x),n.y&&(i.Y=1e3*e.y),i.Z=1e3*e.z}}if("number"==typeof t.volumeThreshold&&(i.T=t.volumeThreshold),"number"==typeof t.hiFiGain&&(i.g=Math.max(0,t.hiFiGain)),"number"==typeof t.userAttenuation&&(i.a=t.userAttenuation),"number"==typeof t.userRolloff&&(i.r=Math.max(0,t.userRolloff)),0===Object.keys(i).length)return{success:!0,stringifiedDataForMixer:JSON.stringify({})};{let t=this._raviSession.getCommandController();if(t){let e=JSON.stringify(i);return t.sendInput(e),{success:!0,stringifiedDataForMixer:e}}return{success:!1,error:"Can't transmit data to mixer; no `commandController`!."}}}_resetMixerInfo(){this.mixerInfo={connected:!1}}}},817:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.UserDataSubscription=e.AvailableUserDataSubscriptionComponents=void 0,(i=e.AvailableUserDataSubscriptionComponents||(e.AvailableUserDataSubscriptionComponents={})).Position="Position",i.OrientationEuler="Orientation (Euler)",i.OrientationQuat="Orientation (Quaternion)",i.VolumeDecibels="Volume (Decibels)",i.HiFiGain="HiFiGain",e.UserDataSubscription=class{constructor({providedUserID:t=null,components:e,callback:i}){this.providedUserID=t,this.components=e,this.callback=i}}},709:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HiFiConstants=void 0;class i{constructor(){}}e.HiFiConstants=i,i.MIN_TRANSMIT_RATE_LIMIT_TIMEOUT_MS=10,i.DEFAULT_TRANSMIT_RATE_LIMIT_TIMEOUT_MS=50,i.DEFAULT_PROD_HIGH_FIDELITY_ENDPOINT="api.highfidelity.com"},607:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(441),a=i(468),s=i(817),o=i(649),r=i(24),l=i(709),d=i(641);let h="undefined"!=typeof self;h&&(e.HiFiAPIVersion="v0.4.3"),e.HiFiCommunicator=a.HiFiCommunicator,e.HiFiConnectionStates=a.HiFiConnectionStates,e.HiFiUserDataStreamingScopes=a.HiFiUserDataStreamingScopes,e.AvailableUserDataSubscriptionComponents=s.AvailableUserDataSubscriptionComponents,e.UserDataSubscription=s.UserDataSubscription,e.ReceivedHiFiAudioAPIData=n.ReceivedHiFiAudioAPIData,e.HiFiAudioAPIData=n.HiFiAudioAPIData,e.Point3D=n.Point3D,e.OrientationEuler3D=n.OrientationEuler3D,e.OrientationQuat3D=n.OrientationQuat3D,e.eulerToQuaternion=n.eulerToQuaternion,e.eulerFromQuaternion=n.eulerFromQuaternion,e.HiFiLogger=o.HiFiLogger,e.HiFiLogLevel=o.HiFiLogLevel,e.getBestAudioConstraints=r.getBestAudioConstraints,e.preciseInterval=r.preciseInterval,e.HiFiConstants=l.HiFiConstants,e.HiFiAxes=d.HiFiAxes,e.HiFiHandedness=d.HiFiHandedness,e.HiFiAxisConfiguration=d.HiFiAxisConfiguration,h&&(e.apiVersion="v0.4.3"),e.Communicator=a.HiFiCommunicator,e.ConnectionStates=a.HiFiConnectionStates,e.UserDataStreamingScopes=a.HiFiUserDataStreamingScopes,e.AvailableUserDataSubscriptionComponents=s.AvailableUserDataSubscriptionComponents,e.UserDataSubscription=s.UserDataSubscription,e.ReceivedAudioAPIData=n.ReceivedHiFiAudioAPIData,e.AudioAPIData=n.HiFiAudioAPIData,e.Point3D=n.Point3D,e.OrientationEuler3D=n.OrientationEuler3D,e.OrientationQuat3D=n.OrientationQuat3D,e.Logger=o.HiFiLogger,e.LogLevel=o.HiFiLogLevel,e.getBestAudioConstraints=r.getBestAudioConstraints,e.preciseInterval=r.preciseInterval,e.Constants=l.HiFiConstants,e.Axes=d.HiFiAxes,e.Handedness=d.HiFiHandedness,e.AxisConfiguration=d.HiFiAxisConfiguration},318:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RaviCommandController=void 0;const n=i(425),a="_BINARY";var s;!function(t){t[t.ControlLeft=0]="ControlLeft",t[t.AltLeft=1]="AltLeft",t[t.OSLeft=2]="OSLeft",t[t.Space=3]="Space",t[t.OSRight=4]="OSRight",t[t.AltRight=5]="AltRight",t[t.ControlRight=6]="ControlRight",t[t.ShiftLeft=7]="ShiftLeft",t[t.ShiftRight=8]="ShiftRight",t[t.Comma=9]="Comma",t[t.Period=10]="Period",t[t.Slash=11]="Slash",t[t.CapsLock=12]="CapsLock",t[t.Enter=13]="Enter",t[t.Semicolon=14]="Semicolon",t[t.Quote=15]="Quote",t[t.Tab=16]="Tab",t[t.BracketLeft=17]="BracketLeft",t[t.BracketRight=18]="BracketRight",t[t.Backslash=19]="Backslash",t[t.Backquote=20]="Backquote",t[t.Minus=21]="Minus",t[t.Equal=22]="Equal",t[t.Digit0=23]="Digit0",t[t.Digit1=24]="Digit1",t[t.Digit2=25]="Digit2",t[t.Digit3=26]="Digit3",t[t.Digit4=27]="Digit4",t[t.Digit5=28]="Digit5",t[t.Digit6=29]="Digit6",t[t.Digit7=30]="Digit7",t[t.Digit8=31]="Digit8",t[t.Digit9=32]="Digit9",t[t.Backspace=33]="Backspace",t[t.Escape=34]="Escape",t[t.ArrowLeft=35]="ArrowLeft",t[t.ArrowRight=36]="ArrowRight",t[t.ArrowDown=37]="ArrowDown",t[t.ArrowUp=38]="ArrowUp",t[t.PageDown=39]="PageDown",t[t.PageUp=40]="PageUp",t[t.End=41]="End",t[t.Home=42]="Home",t[t.Delete=43]="Delete",t[t.Insert=44]="Insert",t[t.Numpad0=45]="Numpad0",t[t.Numpad1=46]="Numpad1",t[t.Numpad2=47]="Numpad2",t[t.Numpad3=48]="Numpad3",t[t.Numpad4=49]="Numpad4",t[t.Numpad5=50]="Numpad5",t[t.Numpad6=51]="Numpad6",t[t.Numpad7=52]="Numpad7",t[t.Numpad8=53]="Numpad8",t[t.Numpad9=54]="Numpad9",t[t.NumpadDecimal=55]="NumpadDecimal",t[t.NumpadEnter=56]="NumpadEnter",t[t.NumpadAdd=57]="NumpadAdd",t[t.NumpadSubtract=58]="NumpadSubtract",t[t.NumLock=59]="NumLock",t[t.NumpadEqual=60]="NumpadEqual",t[t.NumpadMultiply=61]="NumpadMultiply",t[t.NumpadDivide=62]="NumpadDivide",t[t.KeyA=63]="KeyA",t[t.KeyB=64]="KeyB",t[t.KeyC=65]="KeyC",t[t.KeyD=66]="KeyD",t[t.KeyE=67]="KeyE",t[t.KeyF=68]="KeyF",t[t.KeyG=69]="KeyG",t[t.KeyH=70]="KeyH",t[t.KeyI=71]="KeyI",t[t.KeyJ=72]="KeyJ",t[t.KeyK=73]="KeyK",t[t.KeyL=74]="KeyL",t[t.KeyM=75]="KeyM",t[t.KeyN=76]="KeyN",t[t.KeyO=77]="KeyO",t[t.KeyP=78]="KeyP",t[t.KeyQ=79]="KeyQ",t[t.KeyR=80]="KeyR",t[t.KeyS=81]="KeyS",t[t.KeyT=82]="KeyT",t[t.KeyU=83]="KeyU",t[t.KeyV=84]="KeyV",t[t.KeyW=85]="KeyW",t[t.KeyX=86]="KeyX",t[t.KeyY=87]="KeyY",t[t.KeyZ=88]="KeyZ"}(s||(s={})),e.RaviCommandController=class{constructor(){n.RaviUtils.log("constructor","RaviCommandController"),this._commandQueueMap=new Map,this._numQueuedCommands=0,this._commandQueueInterval=1e3,this._commandPumpTimer=null,this._inputTarget,this._keyboardTarget,this._mouseStateBuffer=new ArrayBuffer(32),this._mouseStateUint8=new Uint8Array(this._mouseStateBuffer),this._mouseStateUint8[0]=77,this._mouseStateFloat=new Float32Array(this._mouseStateBuffer,4),this._mouseStateFloat[0]=-1,this._mouseStateFloat[1]=-1,this._mouseStateFloat[2]=-1,this._mouseStateFloat[3]=-1,this._keyboardStateBuffer=new ArrayBuffer(13),this._keyboardState=new Uint8Array(this._keyboardStateBuffer),this._keyboardState[0]=75}setCommandQueueInterval(t){this._commandQueueInterval=t,this._commandPumpTimer&&(this.stopMonitoringQueues(),this.monitorQueues())}queueCommand(t,e,i){var a=this._commandQueueMap.get(t);a||(a={toSend:[],listener:[]},this._commandQueueMap.set(t,a));var s=null;i&&(s=new r(i,!1,!0)),a.toSend.push(new o(t,e,s)),this._numQueuedCommands++,n.RaviUtils.log("Added command "+t,"RaviCommandController")}queueBinaryCommand(t){let e=a;var i=this._commandQueueMap.get(e);i||(i={toSend:[],listener:[]},this._commandQueueMap.set(e,i)),i.toSend.push(new o(t,null,null)),this._numQueuedCommands++,n.RaviUtils.log("Added binary command","RaviCommandController")}addMessageHandler(t,e,i){var n=this._commandQueueMap.get(t);n||(n={toSend:[],listener:[]},this._commandQueueMap.set(t,n));var a=new r(e,i,!1);n.listener.push(a)}addBinaryHandler(t,e){this.addMessageHandler(a,t,e)}sendInput(t){this._inputDataChannel&&"open"===this._inputDataChannel.readyState&&this._inputDataChannel.send(t)}monitorQueues(){n.RaviUtils.log("Begin monitoring for queued commands","RaviCommandController"),this._commandPumpTimer=setInterval(this._processSendingQueuedCommands.bind(this),this._commandQueueInterval)}stopMonitoringQueues(){n.RaviUtils.log("Stop monitoring for queued commands","RaviCommandController"),clearInterval(this._commandPumpTimer),this._commandPumpTimer=null}_processSendingQueuedCommands(){this._numQueuedCommands<=0||this._commandQueueMap.forEach(function(t,e,i){if(t.toSend.length){var a=t.toSend.shift();a._handler&&t.listener.push(a._handler),this._sendCommandInstance(a)?this._numQueuedCommands--:n.RaviUtils.log("Send failed. CommandDataChannel may have been disconnected. Will not retry.","RaviCommandController")}}.bind(this))}_serializeJsonCommandMessageToSend(t,e){return JSON.stringify({c:t,p:e})}_unserializeJsonCommandMessageFromReceived(t){let e;try{e=JSON.parse(t)}catch(e){return void n.RaviUtils.err(`Couldn't parse command message! Error:\n${e}\n Full message contents:\n${t}`,"RaviCommandController")}return e&&e.c&&e.p?{command:e.c,payload:e.p}:(n.RaviUtils.err("Message cannot be unserialized into a CommandMessage: "+t,"RaviCommandController"),null)}_sendCommandInstance(t){try{let e=t._command;return"string"==typeof e?(e=this._serializeJsonCommandMessageToSend(t._command,t._param),n.RaviUtils.log("Sending command "+e,"RaviCommandController")):n.RaviUtils.log("Sending binary command","RaviCommandController"),this._commandDataChannel.send(e),!0}catch(t){return n.RaviUtils.err("Received error while sending: "+t.message,"RaviCommandController"),!1}}_processListeningCommand(t){let e=t.data,i=null;e&&("string"==typeof e?(i=this._unserializeJsonCommandMessageFromReceived(e),this._continueProcessingListeningCommand(i)):e instanceof ArrayBuffer?(i={command:a,payload:new Uint8Array(e)},this._continueProcessingListeningCommand(i)):e instanceof Blob&&e.arrayBuffer().then((t=>{i={command:a,payload:new Uint8Array(t)},this._continueProcessingListeningCommand(i)})))}_continueProcessingListeningCommand(t){if(t){n.RaviUtils.log("_continueProcessingListeningCommand: "+t,"RaviCommandController");var e=this._commandQueueMap.get(t.command);if(e){var i=e.listener.length;if(i>0)if(e.listener[0]&&e.listener[0]._hasMatchingSentCommand){var a=e.listener.shift();if(a&&a._handler)return void a._handler(t.payload);n.RaviUtils.err("Undefined command handler: "+t,"RaviCommandController")}else{for(var s=[],o=0;o<i;o++){var r=e.listener[o];r&&r._handler?r._handler(t.payload):n.RaviUtils.err("Undefined message handler: "+t,"RaviCommandController"),r&&r._isSticky&&s.push(r)}e.listener=s}}}else n.RaviUtils.err("Received invalid command message, ignoring: "+JSON.stringify(t),"RaviCommandController")}_setInputDataChannel(t){this._inputDataChannel=t,n.RaviUtils.log("Received new input data channel with id "+this._inputDataChannel.id,"RaviCommandController"),this._inputDataChannel.onopen=function(){n.RaviUtils.log("_inputDataChannel onopen, state is "+this._inputDataChannel.readyState,"RaviCommandController")}.bind(this),this._inputDataChannel.onclose=function(){n.RaviUtils.log("_inputDataChannel onclose, state is "+this._inputDataChannel.readyState,"RaviCommandController")}.bind(this),this._inputDataChannel.onmessage=function(t){n.RaviUtils.log("_inputDataChannel got message: "+t.data,"RaviCommandController")}.bind(this)}_setCommandDataChannel(t){this._commandDataChannel=t,n.RaviUtils.log("Received new data channel with id "+this._commandDataChannel.id,"RaviCommandController"),this._commandDataChannel.onopen=function(){n.RaviUtils.log("_commandDataChannel ononpen, state is "+this._commandDataChannel.readyState,"RaviCommandController"),this.monitorQueues()}.bind(this),this._commandDataChannel.onclose=function(){n.RaviUtils.log("_commandDataChannel onclose, state is "+this._commandDataChannel.readyState,"RaviCommandController"),this.stopMonitoringQueues()}.bind(this),this._commandDataChannel.onmessage=function(t){this._processListeningCommand(t)}.bind(this)}setInputTarget(t){if(this._inputTarget&&(this._inputTarget.onmousemove=null,this._inputTarget.onmouseenter=null,this._inputTarget.onmouseleave=null,this._inputTarget.onmousedown=null,this._inputTarget.onmouseup=null,this._inputTarget.onwheel=null),this._inputTarget=t,this._inputTarget){var e=this;this._inputTarget.onmousemove=function(t){e._trackMouse(t)},this._inputTarget.onmouseenter=null,this._inputTarget.onmouseleave=null,this._inputTarget.onmousedown=function(t){e._captureMouseDown(t)},this._inputTarget.onmouseup=function(t){e._resetMouseDown(t)},this._inputTarget.onwheel=function(t){e._wheelMouse(t)}}}setKeyboardTarget(t){if(this._keyboardTarget&&(this._keyboardTarget.onkeydown=null,this._keyboardTarget.onkeyup=null),this._keyboardTarget=t,this._keyboardTarget){var e=this;this._keyboardTarget.onkeydown=function(t){e._onKeyboardDown(t)},this._keyboardTarget.onkeyup=function(t){e._onKeyboardUp(t)}}}_captureMouseDown(t){this._mouseStateFloat[0]=t.offsetX,this._mouseStateFloat[1]=t.offsetY,this._mouseStateFloat[2]=t.offsetX,this._mouseStateFloat[3]=t.offsetY,this._mouseStateUint8[1]=t.buttons,this._sendMouseState()}_resetMouseDown(t){this._mouseStateFloat[0]=-1,this._mouseStateFloat[1]=-1,this._mouseStateFloat[2]=-1,this._mouseStateFloat[3]=-1,this._mouseStateUint8[1]=t.buttons,this._sendMouseState()}_trackMouse(t){this._mouseStateFloat[0]=t.offsetX,this._mouseStateFloat[1]=t.offsetY,this._mouseStateFloat[4]=this._inputTarget.offsetWidth,this._mouseStateFloat[5]=this._inputTarget.offsetHeight,this._mouseStateUint8[1]=t.buttons,this._sendMouseState()}_wheelMouse(t){this._mouseStateFloat[6]=t.deltaY,this._sendMouseState(),this._mouseStateFloat[6]=0}_sendMouseState(){this.sendInput(this._mouseStateBuffer)}_keyByteNum(t){return t>>3}_keyBitMask(t){return 1<<t%8}_onKeyboardDown(t){let e=s[t.code],i=1+this._keyByteNum(e),n=this._keyBitMask(e);0==(this._keyboardState[i]&n)&&(this._keyboardState[i]|=n,this._sendKeyboardState())}_onKeyboardUp(t){let e=s[t.code],i=1+this._keyByteNum(e),n=this._keyBitMask(e);0!=(this._keyboardState[i]&n)&&(this._keyboardState[i]^=n,this._sendKeyboardState())}_sendKeyboardState(){this.sendInput(this._keyboardStateBuffer)}};class o{constructor(t,e,i){n.RaviUtils.log("constructor","RaviCommandInstance"),this._command=t,this._param=e,this._handler=i}}class r{constructor(t,e,i){n.RaviUtils.log("constructor","RaviCommandHandlerInstance"),this._handler=t,this._isSticky=e,this._hasMatchingSentCommand=i}}},665:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function r(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,r)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.RaviSession=e.RaviSessionStates=void 0;const a=i(562),s=i(425),o=i(318);var r;!function(t){t.NEW="new",t.CONNECTING="checking",t.CONNECTED="connected",t.COMPLETED="completed",t.DISCONNECTED="disconnected",t.FAILED="failed",t.CLOSED="closed"}(r=e.RaviSessionStates||(e.RaviSessionStates={})),e.RaviSession=class{constructor(){s.RaviUtils.log("Constructor","RaviSession"),this._stateChangeHandlers=new Set,this._uuid=s.RaviUtils.createUUID(),this._commandController=new o.RaviCommandController,this._streamController=new a.RaviStreamController(this._commandController),this._state=r.CLOSED,this._raviImplementation=new _(this);const t=this._raviImplementation;this._streamController.setInputAudioChangeHandler(t._addAudioInputStream.bind(t)),this._streamController.setInputVideoChangeHandler(t._addVideoInputStream.bind(t))}getState(){return this._state}getUUID(){return this._uuid}addStateChangeHandler(t){try{return this._stateChangeHandlers.add(t),!0}catch(t){return s.RaviUtils.err("Error adding a state change handler: "+t.message,"RaviSession"),!1}return!1}removeStateChangeHandler(t){try{return this._stateChangeHandlers.delete(t),!0}catch(t){return s.RaviUtils.err("Error removing a state change handler: "+t.message,"RaviSession"),!1}return!1}getCommandController(){return this._commandController}getStreamController(){return this._streamController}open(t,e=5e3,i=null){var n=this;return this._raviImplementation._assignSignalingConnection(t),new Promise(((t,a)=>{s.RaviUtils.log("Opening RAVI session","RaviSession");let o=setTimeout((()=>{s.RaviUtils.log("RaviSession.open timed out after "+e+" ms","RaviSession"),a(Error("RaviSession.open timed out")),n.close()}),e);const l=function(e){var i="";e&&e.state&&(i=e.state),i===r.NEW||i===r.CONNECTING||i===r.DISCONNECTED?s.RaviUtils.log("RAVI session state is "+i,"RaviSession"):i===r.CONNECTED||i===r.COMPLETED?(d(),t(i)):i===r.FAILED?(d(),setTimeout((()=>{n._raviImplementation._close()}),0),a(Error(i))):i===r.CLOSED&&(d(),a(Error(i)))},d=function(){n.removeStateChangeHandler(l),o&&(clearTimeout(o),o=null)};n.addStateChangeHandler(l),n._raviImplementation._open(i)}))}close(){var t=this;return this._streamController._stop(),this._commandController.stopMonitoringQueues(),new Promise(((e,i)=>{s.RaviUtils.log("Closing RAVI session","RaviSession");const n=function(a){var o="";a&&a.state&&(o=a.state),o===r.DISCONNECTED?s.RaviUtils.log("Closing...","RaviSession"):o===r.CLOSED?(t.removeStateChangeHandler(n),e(o)):(t.removeStateChangeHandler(n),i(Error(o)))};t.addStateChangeHandler(n);var a={state:r.DISCONNECTED};t._handleStateChange(a,r.DISCONNECTED),t._raviImplementation._close()}))}_doOntrack(t){s.RaviUtils.log("Received new track: ","RaviSession"),s.RaviUtils.log(t,"RaviSession"),t&&t.track&&"video"===t.track.kind&&(s.RaviUtils.log("Adding remote video track to stream controller","RaviSession"),this._streamController._setVideoStream(t.streams[0]),this._streamController._onVideoStreamStateChanged("ready")),t&&t.track&&"audio"===t.track.kind&&(s.RaviUtils.log("Adding remote audio track to stream controller","RaviSession"),this._streamController._setAudioStream(t.streams[0]))}_doOndatachannel(t){switch(s.RaviUtils.log("Received new channel: ","RaviSession"),s.RaviUtils.log(t,"RaviSession"),t.channel.label){case"ravi.input":this._commandController._setInputDataChannel(t.channel);break;case"ravi.command":this._commandController._setCommandDataChannel(t.channel);break;default:s.RaviUtils.log("Received unknown data channel named "+t.channel.label,"RaviSession")}}_handleStateChange(t,e){this._state=e,t&&(t.state=e,s.RaviUtils.log("_handleStateChange: "+JSON.stringify(t),"RaviSession"),this._stateChangeHandlers.forEach((function(e){e&&e(t)})))}addStatsObserver(t){return this._raviImplementation._addStatsObserver(t)}removeStatsObserver(t){return this._raviImplementation._removeStatsObserver(t)}};const l=new Map([["remote-inbound-rtp",["id","type","timestamp","roundTripTime","jitter"]],["inbound-rtp",["id","type","timestamp","jitterBufferDelay","jitterBufferEmittedCount","bytesReceived"]]]);class d{constructor(t){s.RaviUtils.log("constructor","RaviStatsWatcher"),this._raviImplementation=t,this._observers=new Set,this._filter=l,this._interval=0,this._prevStats=[]}stop(){this._interval&&(window.clearInterval(this._interval),this._interval=0)}addObserver(t){try{return this._observers.add(t),this._onObserverChange(),!0}catch(t){return s.RaviUtils.err("Error adding a stats observer: "+t.message,"RaviStatsWatcher"),!1}return!1}removeObserver(t){try{return this._observers.delete(t),this._onObserverChange(),!0}catch(t){return s.RaviUtils.err("Error removing a stats observer handler: "+t.message,"RaviSession"),!1}return!1}_onObserverChange(){this._prevStats=[],this._observers.size>0?this._interval||window.setInterval(((t,e)=>n(this,void 0,void 0,(function*(){const t=yield this._raviImplementation._getStats();let e=[];t&&t.forEach((t=>{if(this._filter.has(t.type)){let i=this._filter.get(t.type),n={};i.forEach((e=>{n[e]=t[e]})),e.push(n)}})),e.length&&this._observers.forEach((t=>{t(e,this._prevStats)})),this._prevStats=e}))),1e3):this._interval&&(window.clearInterval(this._interval),this._interval=0)}}let h=null,u=null;"undefined"==typeof self?(h=i(326).I$,u=i(326).Ao):(h=RTCPeerConnection,u=RTCSessionDescription);const c={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:turn.highfidelity.com:3478",username:"clouduser",credential:"chariot-travesty-hook"}]};class _{constructor(t){s.RaviUtils.log("constructor","RaviWebRTCImplementation"),this._raviSession=t,this._negotiator=this._setupConnection.bind(this),this._initRtcConnection(),this._statsWatcher=new d(this)}_initRtcConnection(){const t=this._raviSession,e=this;this._rtcConnection=new h(c);const i=this._rtcConnection;i.getSenders().forEach((t=>{t.replaceTrack(null)})),this._raviAudioSenders=[],this._raviVideoSenders=[],i.addEventListener("iceconnectionstatechange",(function(e){t._handleStateChange(e,i.iceConnectionState)})),i.addEventListener("datachannel",(function(e){t._doOndatachannel(e)})),i.addEventListener("track",(function(e){t._doOntrack(e)})),i.addEventListener("icecandidate",(function(t){e._doOnicecandidate(t)})),i.addEventListener("negotiationneeded",(function(t){e._doOnnegotiationneeded(t)})),i.addEventListener("signalingstatechange",(function(t){e._doOnsignalingstatechanged(t)}))}_assignSignalingConnection(t){this._signalingConnection=t}_addAudioInputStream(t){const e=this._rtcConnection;if(t){const i=this._raviAudioSenders,n=t.getAudioTracks(),a=n.length;let o=0;for(;o<i.length;o++)o<a?(s.RaviUtils.log("Replacing audio track #"+o+"  in rtcConnection","RaviWebRTCImplementation"),i[o].replaceTrack(n[o])):(s.RaviUtils.log("Setting audio sender #"+o+" to null","RaviWebRTCImplementation"),i[o].replaceTrack(null));for(;o<a;o++)s.RaviUtils.log("Adding local audio track #"+o+" to rtcConnection","RaviWebRTCImplementation"),i.push(e.addTrack(n[o],t))}else{const t=this._raviAudioSenders;let e=0;for(;e<t.length;e++)s.RaviUtils.log("Setting audio sender #"+e+" to null","RaviWebRTCImplementation"),t[e].replaceTrack(null)}return!1}_addVideoInputStream(t){const e=this._rtcConnection;var i=!1;if(t){const n=this._raviVideoSenders,a=t.getVideoTracks();a.length>0?(n.length>0?(s.RaviUtils.log("Replacing video track #0 in rtcConnection","RaviWebRTCImplementation"),n[0].replaceTrack(a[0])):(s.RaviUtils.log("Adding video track #0 to rtcConnection","RaviWebRTCImplementation"),n.push(e.addTrack(a[0]))),i=!0):s.RaviUtils.log("Assigned video stream doesn't contain vidoe track","RaviWebRTCImplementation")}else{const t=this._raviVideoSenders;let e=0;for(;e<t.length;e++)s.RaviUtils.log("Setting video sender #"+e+" to null","RaviWebRTCImplementation"),t[e].replaceTrack(null)}return i}_open(t){if(s.RaviUtils.log("Attempting to open connection...","RaviWebRTCImplementation"),"connecting"==this._rtcConnection.connectionState||"connected"==this._rtcConnection.connectionState)return s.RaviUtils.log("We already have a connection in progress. Will not attempt a new one.","RaviWebRTCImplementation"),void this._raviSession._handleStateChange({state:this._rtcConnection.connectionState},this._rtcConnection.connectionState);if(this._signalingConnection){this._signalingConnection.addMessageHandler(this._negotiator);let e={};t?(e=t,e.sessionID=this._raviSession.getUUID()):e=this._raviSession.getUUID(),this._signalingConnection.send(JSON.stringify({request:e}))}}_close(){if(this._rtcConnection){this._statsWatcher.stop(),s.RaviUtils.log("closing","RaviWebRTCImplementation"),this._rtcConnection.close(),this._rtcConnection=null;var t={state:r.CLOSED};this._raviSession._handleStateChange(t,r.CLOSED),this._signalingConnection.removeMessageHandler(this._negotiator),this._initRtcConnection()}}_doOnicecandidate(t){t.candidate&&""!=t.candidate?(s.RaviUtils.log("Sending local ICE candidate: "+JSON.stringify(t.candidate),"RaviWebRTCImplementation"),this._signalingConnection.send(JSON.stringify({ice:t.candidate,uuid:this._raviSession.getUUID()}))):s.RaviUtils.log("End of local ICE candidates","RaviSession")}_doOnnegotiationneeded(t){s.RaviUtils.log("need renegotiation please","RaviWebRTCImplementation");const e={renegotiate:"please",uuid:this._raviSession.getUUID()},i=JSON.stringify(e);this._signalingConnection&&"stable"===this._rtcConnection.signalingState&&this._signalingConnection.send(i)}_doOnsignalingstatechanged(t){s.RaviUtils.log("SignalingState changed: "+this._rtcConnection.signalingState,"RaviWebRTCImplementation")}_forceBitrateUp(t){const e=this._raviSession._streamController.isStereoInput()?128e3:64e3;return t.replace(/a=fmtp:111 /g,"a=fmtp:111 maxaveragebitrate="+e+";")}_forceStereoDown(t){return t.replace(/a=fmtp:111 /g,"a=fmtp:111 maxaveragebitrate=128000;sprop-stereo=1;stereo=1;")}_setupConnection(t){let e="",i="";const n=this._raviSession,a=this._rtcConnection,o=this._signalingConnection,r=this;if(n&&a&&o)if(t&&t.data){if(s.RaviUtils.log("Message from server: "+t.data,"RaviWebRTCImplementation"),e=JSON.parse(t.data),i=e[n.getUUID()],i)if(i.sdp){s.RaviUtils.log("Got sdp of type:"+i.type,"RaviWebRTCImplementation"),i.sdp=r._forceBitrateUp(i.sdp);const t=new u(i);a.setRemoteDescription(t).then((function(){return a.createAnswer()})).then((function(t){return t.sdp=r._forceStereoDown(t.sdp),s.RaviUtils.log("Answer:","RaviWebRTCImplementation"),s.RaviUtils.log(t,"RaviWebRTCImplementation"),a.setLocalDescription(t)})).then((function(){const t={type:"answer",sdp:a.localDescription,uuid:n.getUUID()},e=JSON.stringify(t);s.RaviUtils.log("Sending answer to server","RaviWebRTCImplementation"),o.send(e)}))}else i.ice?(s.RaviUtils.log("Received remote ICE candidate: "+JSON.stringify(i.ice),"RaviWebRTCImplementation"),a.addIceCandidate(i.ice).then((function(){s.RaviUtils.log("Added remote candidate","RaviWebRTCImplementation")})).catch((function(t){s.RaviUtils.err("Error attempting to add remote ICE candidate: "+t.message,"RaviWebRTCImplementation")}))):s.RaviUtils.log("Unknown message "+JSON.stringify(i),"RaviWebRTCImplementation")}else s.RaviUtils.log("No message received by onMessage handler","RaviWebRTCImplementation");else s.RaviUtils.err("Missing one of raviSession, rtcConnection, or signalingConnection! Can't set up connection.","RaviWebRTCImplementation")}_addStatsObserver(t){return this._statsWatcher.addObserver(t)}_removeStatsObserver(t){return this._statsWatcher.removeObserver(t)}_getStats(t=null){return n(this,void 0,void 0,(function*(){return this._rtcConnection?this._rtcConnection.getStats(t):{}}))}}},212:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RaviSignalingConnection=e.RaviSignalingStates=void 0;const n=i(425);var a;!function(t){t.CONNECTING="connecting",t.OPEN="open",t.ERROR="error",t.CLOSING="closing",t.CLOSED="closed",t.UNAVAILABLE="unavailable"}(a=e.RaviSignalingStates||(e.RaviSignalingStates={})),e.RaviSignalingConnection=class{constructor(){n.RaviUtils.log("Constructor","RaviSignalingConnection"),this._stateChangeHandlers=new Set,this._messageHandlers=new Set,this._state=a.CLOSED,this._signalingImplementation=new o(this)}getState(){return this._state}addStateChangeHandler(t){try{return this._stateChangeHandlers.add(t),!0}catch(t){return n.RaviUtils.err("Error adding a state change handler: "+t.message,"RaviSignalingConnection"),!1}return!1}removeStateChangeHandler(t){try{return this._stateChangeHandlers.delete(t),!0}catch(t){return n.RaviUtils.err("Error removing a state change handler: "+t.message,"RaviSignalingConnection"),!1}return!1}addMessageHandler(t){try{return this._messageHandlers.add(t),!0}catch(t){return n.RaviUtils.err("Error adding a message handler: "+t.message,"RaviSignalingConnection"),!1}return!1}removeMessageHandler(t){try{return this._messageHandlers.delete(t),!0}catch(t){return n.RaviUtils.err("Error removing a state change handler: "+t.message,"RaviSignalingConnection"),!1}return!1}open(t){var e=this;return new Promise(((i,s)=>{n.RaviUtils.log("Opening signaling connection to "+t,"RaviSignalingController");const o=function(t){var r="";t&&t.state&&(r=t.state),r===a.CONNECTING?n.RaviUtils.log("Connecting...","RaviSignalingController"):r===a.OPEN?(e.removeStateChangeHandler(o),i(r)):(e.removeStateChangeHandler(o),s(t.error||new Error(t.message||r)))};e.addStateChangeHandler(o);var r={state:a.CONNECTING};this._handleStateChange(r,a.CONNECTING),this._signalingImplementation._open(t)}))}send(t){this._signalingImplementation._send(t)}close(){var t=this;return new Promise(((e,i)=>{n.RaviUtils.log("Closing signaling connection","RaviSignalingConnection");const s=function(o){var r="";o&&o.state&&(r=o.state),r===a.CLOSING?n.RaviUtils.log("Closing...","RaviSignalingConnection"):r===a.CLOSED?(t.removeStateChangeHandler(s),e(r)):(t.removeStateChangeHandler(s),i(Error(r)))};t.addStateChangeHandler(s);var o={state:a.CLOSING};this._handleStateChange(o,a.CLOSING),this._signalingImplementation._close()}))}_handleStateChange(t,e){this._state=e,t.state=e,n.RaviUtils.log("_handleStateChange: "+n.RaviUtils.safelyPrintable(t),"RaviSignalingConnection"),this._stateChangeHandlers.forEach((function(e){e&&e(t)}))}_handleMessage(t){if(n.RaviUtils.log("_doOnmessage: "+n.RaviUtils.safelyPrintable(t),"RaviSignalingConnection"),t.data)try{let e=JSON.parse(t.data);e.error&&"service-unavailable"==e.error&&this._handleStateChange({},a.UNAVAILABLE)}catch(t){}this._messageHandlers.forEach((function(e){e&&e(t)}))}};let s=null;s="undefined"==typeof self?i(26):WebSocket;class o{constructor(t){n.RaviUtils.log("constructor","RaviSignalingWebSocketImplementation"),this._raviSignalingConnection=t}_open(t){this._webSocket=new s(t);var e=this._raviSignalingConnection;this._webSocket.addEventListener("open",(function(t){e._handleStateChange(t,a.OPEN)})),this._webSocket.addEventListener("error",(function(t){e._handleStateChange(t,a.ERROR)})),this._webSocket.addEventListener("close",(function(t){e._handleStateChange(t,a.CLOSED)})),this._webSocket.addEventListener("message",(function(t){e._handleMessage(t)}))}_send(t){this._webSocket&&this._webSocket.readyState===s.OPEN&&(n.RaviUtils.log("Sending message to server: "+t,"RaviSignalingWebSocketImplementation"),this._webSocket.send(t))}_close(){this._webSocket&&(this._webSocket.close(),this._webSocket=null)}}t.exports.RaviSignalingStates=a},562:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RaviStreamController=void 0;const n=i(425);e.RaviStreamController=class{constructor(t){n.RaviUtils.log("constructor","RaviStreamController"),this._commandController=t,this._audioStream=null,this._videoStream=null,this._onVideoStreamStateChanged=function(t){n.RaviUtils.log("onvideostreamstatechanged "+t,"RaviStreamController")},this._onInputAudioChanged=null,this._onInputVideoChanged=null}getVideoStream(){return this._videoStream}_setVideoStream(t){this._videoStream=t,this._videoContainer&&(this._videoContainer.srcObject=this._videoStream)}setVideoContainer(t,e){this._videoContainer=t,this._videoStream&&(this._videoContainer.srcObject=this._videoStream),this.setVideoStateChangeHandler(e)}setVideoStateChangeHandler(t){t&&(this._onVideoStreamStateChanged=t)}showVideoDashboard(t){this._commandController.queueCommand("video.showDashboard",{enabled:t},null)}showVideoCursor(t){this._commandController.queueCommand("video.showCursor",{enabled:t},null)}getAudioStream(){return this._audioStream}_setAudioStream(t){this._audioStream=t,this._audioContainer&&(this._audioContainer.srcObject=this._audioStream)}setAudioContainer(t){this._audioContainer=t,this._audioStream&&(this._audioContainer.srcObject=this._audioStream)}setInputAudio(t,e=!1){this._inputAudioStream=t,this._isStereo=e,this._onInputAudioChanged&&this._onInputAudioChanged(t)}setInputAudioChangeHandler(t){t&&(this._onInputAudioChanged=t)}setInputVideo(t){this._inputVideoStream=t,this._onInputVideoChanged&&this._onInputVideoChanged(t)}setInputVideoChangeHandler(t){t&&(this._onInputVideoChanged=t)}isStereoInput(){return this._isStereo}_stop(){n.RaviUtils.log("stopping streams","RaviStreamController"),this._videoContainer&&this._videoContainer.srcObject&&(this._videoContainer.srcObject.getTracks().forEach((t=>t.stop())),this._videoContainer.srcObject=null,this._onVideoStreamStateChanged("over")),this._audioStream&&(this._audioStream.getTracks().forEach((t=>t.stop())),this._audioStream=null)}}},425:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RaviUtils=void 0;var i=!0;e.RaviUtils=class{static createUUID(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}static log(t,e){if(void 0!==e&&(t=e+": "+t),i&&console.log(t),"undefined"!=typeof document&&i)try{document.dispatchEvent(new CustomEvent("logger",{detail:t}))}catch(e){console.log(t),console.log("Additionally, an error was encountered trying to log that."),console.log(e)}}static err(t,e){void 0!==e&&(t=e+": "+t),console.log("%c %s","color: #FB0A1C",t),"undefined"!=typeof document&&document.dispatchEvent(new CustomEvent("errlogger",{detail:t}))}static safelyPrintable(t){try{return JSON.stringify(t)}catch(e){return t}}static getElementCSSSize(t){if(getComputedStyle){var e=getComputedStyle(t);return{width:parseInt(e.getPropertyValue("width"),10),height:parseInt(e.getPropertyValue("height"),10)}}}static setDebug(t){i=t}}},649:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.HiFiLogger=e.HiFiLogLevel=void 0,function(t){t.None="None",t.Error="Error",t.Warn="Warn",t.Debug="Debug"}(i=e.HiFiLogLevel||(e.HiFiLogLevel={}));class n{constructor(t){t=t||i.Debug}static setHiFiLogLevel(t){n.logLevel=t}static log(t){return n.logLevel===i.Debug&&(console.log(t),!0)}static debug(t){return this.log(t)}static warn(t){return(n.logLevel===i.Debug||n.logLevel===i.Warn)&&(console.warn(t),!0)}static error(t){return(n.logLevel===i.Debug||n.logLevel===i.Warn||n.logLevel===i.Error)&&(console.error(t),!0)}}e.HiFiLogger=n,n.logLevel=i.Error},24:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.preciseInterval=e.getBestAudioConstraints=e.recursivelyDiffObjects=void 0;const n=i(649);let a;if("undefined"==typeof self)try{a=i(513).performance.now}catch(t){}e.recursivelyDiffObjects=function t(e,i){if(!i||"[object Object]"!==Object.prototype.toString.call(i))return e;let n,a={},s=(e,i,n)=>{let s=Object.prototype.toString.call(e),o=Object.prototype.toString.call(i);if("[object Undefined]"!==o)if(s===o)if("[object Object]"!==s)"[object Array]"!==s?"[object Function]"===s?e.toString()!==i.toString()&&(a[n]=i):e!==i&&(a[n]=i):((t,e)=>{if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0})(e,i)||(a[n]=i);else{let s=t(e,i);Object.keys(s).length>0&&(a[n]=s)}else a[n]=i;else a[n]=null};for(n in e)e.hasOwnProperty(n)&&s(e[n],i[n],n);for(n in i)i.hasOwnProperty(n)&&(e[n]||e[n]===i[n]||(a[n]=i[n]));return a},e.getBestAudioConstraints=function(){let t={};return"undefined"!=typeof navigator&&void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getSupportedConstraints&&navigator.mediaDevices.getSupportedConstraints().echoCancellation&&(t.echoCancellation=!1),"undefined"!=typeof navigator&&void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getSupportedConstraints&&navigator.mediaDevices.getSupportedConstraints().noiseSuppression&&(t.noiseSuppression=!1),"undefined"!=typeof navigator&&void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getSupportedConstraints&&navigator.mediaDevices.getSupportedConstraints().autoGainControl&&(t.autoGainControl=!1),t},e.preciseInterval=function(t,e){if(!a)return n.HiFiLogger.warn("`preciseInterval()` is a wrapper for `setInterval()` in the browser context!"),setInterval(t,e);let i=a(),s=clearTimeout,o=()=>{let n=a();if(n<i)return s=clearImmediate,r=setImmediate(o);i+=e,s=clearTimeout,r=setTimeout(o,i-n-2),t()},r=setTimeout(o);return{clear:()=>s(r)}}},326:(t,e)=>{"use strict";window.MediaStream,window.MediaStreamTrack,window.RTCDataChannel,window.RTCDataChannelEvent,window.RTCDtlsTransport,window.RTCIceCandidate,window.RTCIceTransport,e.I$=window.RTCPeerConnection,window.RTCPeerConnectionIceEvent,window.RTCRtpReceiver,window.RTCRtpSender,window.RTCRtpTransceiver,window.RTCSctpTransport,e.Ao=window.RTCSessionDescription,window.getUserMedia,navigator.mediaDevices},26:t=>{"use strict";t.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},513:()=>{}},e={};return function i(n){if(e[n])return e[n].exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,i),a.exports}(607)})();